<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Catch-up | Environmental Systems Data Science</title>
  <meta name="description" content="Text book and exercises for the course Environmental System Data Science at ETH Zürich." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Catch-up | Environmental Systems Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Text book and exercises for the course Environmental System Data Science at ETH Zürich." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Catch-up | Environmental Systems Data Science" />
  
  <meta name="twitter:description" content="Text book and exercises for the course Environmental System Data Science at ETH Zürich." />
  

<meta name="author" content="Loïc Pellissier, Joshua Payne, Benjamin Stocker" />


<meta name="date" content="2021-03-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-04.html"/>
<link rel="next" href="ch-06.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course Description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-objectives"><i class="fa fa-check"></i>Course Objectives</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#content"><i class="fa fa-check"></i>Content</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#useful-prerequisites"><i class="fa fa-check"></i>Useful Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ch-01.html"><a href="ch-01.html"><i class="fa fa-check"></i><b>1</b> Primers</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch-01.html"><a href="ch-01.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="ch-01.html"><a href="ch-01.html#important-points-from-the-lecture"><i class="fa fa-check"></i><b>1.1.1</b> Important points from the lecture</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ch-01.html"><a href="ch-01.html#tutorial"><i class="fa fa-check"></i><b>1.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ch-01.html"><a href="ch-01.html#working-with-jupyter-notebook"><i class="fa fa-check"></i><b>1.2.1</b> Working with Jupyter notebook</a></li>
<li class="chapter" data-level="1.2.2" data-path="ch-01.html"><a href="ch-01.html#using-git-for-version-control"><i class="fa fa-check"></i><b>1.2.2</b> Using Git for version control</a></li>
<li class="chapter" data-level="1.2.3" data-path="ch-01.html"><a href="ch-01.html#basics-of-r-code"><i class="fa fa-check"></i><b>1.2.3</b> Basics of R code</a></li>
<li class="chapter" data-level="1.2.4" data-path="ch-01.html"><a href="ch-01.html#reading-data-into-r"><i class="fa fa-check"></i><b>1.2.4</b> Reading data into R</a></li>
<li class="chapter" data-level="1.2.5" data-path="ch-01.html"><a href="ch-01.html#r-objects"><i class="fa fa-check"></i><b>1.2.5</b> R Objects</a></li>
<li class="chapter" data-level="1.2.6" data-path="ch-01.html"><a href="ch-01.html#data-visualisation"><i class="fa fa-check"></i><b>1.2.6</b> Data visualisation</a></li>
<li class="chapter" data-level="1.2.7" data-path="ch-01.html"><a href="ch-01.html#example-code-loops"><i class="fa fa-check"></i><b>1.2.7</b> Example code: Loops</a></li>
<li class="chapter" data-level="1.2.8" data-path="ch-01.html"><a href="ch-01.html#where-to-find-help"><i class="fa fa-check"></i><b>1.2.8</b> Where to find Help</a></li>
<li class="chapter" data-level="1.2.9" data-path="ch-01.html"><a href="ch-01.html#further-reading"><i class="fa fa-check"></i><b>1.2.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ch-01.html"><a href="ch-01.html#exercise"><i class="fa fa-check"></i><b>1.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-02.html"><a href="ch-02.html"><i class="fa fa-check"></i><b>2</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch-02.html"><a href="ch-02.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="ch-02.html"><a href="ch-02.html#data-transformation-with-dplyr"><i class="fa fa-check"></i><b>2.1.1</b> Data transformation with dplyr</a></li>
<li class="chapter" data-level="2.1.2" data-path="ch-02.html"><a href="ch-02.html#data-visualisation-with-ggplot2"><i class="fa fa-check"></i><b>2.1.2</b> Data visualisation with ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ch-02.html"><a href="ch-02.html#tutorial-1"><i class="fa fa-check"></i><b>2.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="ch-02.html"><a href="ch-02.html#dataset-1-half-hourly-flux-data"><i class="fa fa-check"></i><b>2.2.1</b> Dataset 1 (half-hourly flux data)</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch-02.html"><a href="ch-02.html#dataset-2-daily-flux-data"><i class="fa fa-check"></i><b>2.2.2</b> Dataset 2 (daily flux data)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch-02.html"><a href="ch-02.html#exercise-1"><i class="fa fa-check"></i><b>2.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-03.html"><a href="ch-03.html"><i class="fa fa-check"></i><b>3</b> Data variety</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-03.html"><a href="ch-03.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ch-03.html"><a href="ch-03.html#overview"><i class="fa fa-check"></i><b>3.1.1</b> Overview</a></li>
<li class="chapter" data-level="3.1.2" data-path="ch-03.html"><a href="ch-03.html#learning-objectives"><i class="fa fa-check"></i><b>3.1.2</b> Learning objectives</a></li>
<li class="chapter" data-level="3.1.3" data-path="ch-03.html"><a href="ch-03.html#key-points-of-the-lecture"><i class="fa fa-check"></i><b>3.1.3</b> Key points of the lecture</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ch-03.html"><a href="ch-03.html#tutorial-2"><i class="fa fa-check"></i><b>3.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ch-03.html"><a href="ch-03.html#overview-1"><i class="fa fa-check"></i><b>3.2.1</b> Overview</a></li>
<li class="chapter" data-level="3.2.2" data-path="ch-03.html"><a href="ch-03.html#modis-remote-download"><i class="fa fa-check"></i><b>3.2.2</b> MODIS remote download</a></li>
<li class="chapter" data-level="3.2.3" data-path="ch-03.html"><a href="ch-03.html#points-on-the-globe"><i class="fa fa-check"></i><b>3.2.3</b> Points on the globe</a></li>
<li class="chapter" data-level="3.2.4" data-path="ch-03.html"><a href="ch-03.html#shapefiles"><i class="fa fa-check"></i><b>3.2.4</b> Shapefiles</a></li>
<li class="chapter" data-level="3.2.5" data-path="ch-03.html"><a href="ch-03.html#rasters"><i class="fa fa-check"></i><b>3.2.5</b> Rasters</a></li>
<li class="chapter" data-level="3.2.6" data-path="ch-03.html"><a href="ch-03.html#key-points-of-the-tutorial"><i class="fa fa-check"></i><b>3.2.6</b> Key points of the tutorial</a></li>
<li class="chapter" data-level="3.2.7" data-path="ch-03.html"><a href="ch-03.html#bonus-species-occurrence-trait-data-and-pcas"><i class="fa fa-check"></i><b>3.2.7</b> Bonus: Species Occurrence, Trait Data and PCAs</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ch-03.html"><a href="ch-03.html#exercise-2"><i class="fa fa-check"></i><b>3.3</b> Exercise</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="ch-03.html"><a href="ch-03.html#part-1-plotting-elevation-differences"><i class="fa fa-check"></i><b>3.3.1</b> Part 1: Plotting Elevation differences</a></li>
<li class="chapter" data-level="3.3.2" data-path="ch-03.html"><a href="ch-03.html#part-2-temperature-and-elevation-correlations"><i class="fa fa-check"></i><b>3.3.2</b> Part 2: Temperature and Elevation Correlations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-04.html"><a href="ch-04.html"><i class="fa fa-check"></i><b>4</b> Data Scraping</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch-04.html"><a href="ch-04.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ch-04.html"><a href="ch-04.html#theory"><i class="fa fa-check"></i><b>4.1.1</b> Theory</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ch-04.html"><a href="ch-04.html#tutorial-3"><i class="fa fa-check"></i><b>4.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ch-04.html"><a href="ch-04.html#r-packages-and-functions"><i class="fa fa-check"></i><b>4.2.1</b> R-Packages and Functions</a></li>
<li class="chapter" data-level="4.2.2" data-path="ch-04.html"><a href="ch-04.html#the-fishbase-website"><i class="fa fa-check"></i><b>4.2.2</b> The FishBase website</a></li>
<li class="chapter" data-level="4.2.3" data-path="ch-04.html"><a href="ch-04.html#accessing-fishbase"><i class="fa fa-check"></i><b>4.2.3</b> Accessing FishBase</a></li>
<li class="chapter" data-level="4.2.4" data-path="ch-04.html"><a href="ch-04.html#scraping-numbers"><i class="fa fa-check"></i><b>4.2.4</b> Scraping Numbers</a></li>
<li class="chapter" data-level="4.2.5" data-path="ch-04.html"><a href="ch-04.html#scraping-text-snippetrs"><i class="fa fa-check"></i><b>4.2.5</b> Scraping Text Snippetrs</a></li>
<li class="chapter" data-level="4.2.6" data-path="ch-04.html"><a href="ch-04.html#scraping-tables"><i class="fa fa-check"></i><b>4.2.6</b> Scraping Tables</a></li>
<li class="chapter" data-level="4.2.7" data-path="ch-04.html"><a href="ch-04.html#the-fishbase-package"><i class="fa fa-check"></i><b>4.2.7</b> The Fishbase Package</a></li>
<li class="chapter" data-level="4.2.8" data-path="ch-04.html"><a href="ch-04.html#summary"><i class="fa fa-check"></i><b>4.2.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ch-04.html"><a href="ch-04.html#case-study"><i class="fa fa-check"></i><b>4.3</b> Case Study</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ch-04.html"><a href="ch-04.html#creating-list-of-species"><i class="fa fa-check"></i><b>4.3.1</b> Creating List of Species</a></li>
<li class="chapter" data-level="4.3.2" data-path="ch-04.html"><a href="ch-04.html#extracting-iucn-status-for-all-species"><i class="fa fa-check"></i><b>4.3.2</b> Extracting IUCN Status for all species</a></li>
<li class="chapter" data-level="4.3.3" data-path="ch-04.html"><a href="ch-04.html#proportion-of-species-in-netherlands"><i class="fa fa-check"></i><b>4.3.3</b> Proportion of species in Netherlands</a></li>
<li class="chapter" data-level="4.3.4" data-path="ch-04.html"><a href="ch-04.html#cleaning-data-with-iucn-status"><i class="fa fa-check"></i><b>4.3.4</b> Cleaning data with IUCN Status</a></li>
<li class="chapter" data-level="4.3.5" data-path="ch-04.html"><a href="ch-04.html#maps-of-species-richness-and-red-list-species-proportions"><i class="fa fa-check"></i><b>4.3.5</b> Maps of species richness and Red List species proportions</a></li>
<li class="chapter" data-level="4.3.6" data-path="ch-04.html"><a href="ch-04.html#relation-of-basin-size-and-species-richness"><i class="fa fa-check"></i><b>4.3.6</b> Relation of basin size and species richness</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ch-04.html"><a href="ch-04.html#exercise-3"><i class="fa fa-check"></i><b>4.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-05.html"><a href="ch-05.html"><i class="fa fa-check"></i><b>5</b> Catch-up</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch-05.html"><a href="ch-05.html#loops-in-r"><i class="fa fa-check"></i><b>5.1</b> Loops in R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ch-05.html"><a href="ch-05.html#some-simple-examples"><i class="fa fa-check"></i><b>5.1.1</b> Some simple examples</a></li>
<li class="chapter" data-level="5.1.2" data-path="ch-05.html"><a href="ch-05.html#nested-loops"><i class="fa fa-check"></i><b>5.1.2</b> Nested loops</a></li>
<li class="chapter" data-level="5.1.3" data-path="ch-05.html"><a href="ch-05.html#exercise-4"><i class="fa fa-check"></i><b>5.1.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ch-05.html"><a href="ch-05.html#functional-programming-using-purr"><i class="fa fa-check"></i><b>5.2</b> Functional programming using purr</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ch-05.html"><a href="ch-05.html#shortcuts-in-a-purrr-function"><i class="fa fa-check"></i><b>5.2.1</b> Shortcuts in a <code>purrr</code> function</a></li>
<li class="chapter" data-level="5.2.2" data-path="ch-05.html"><a href="ch-05.html#workflow-nested-data-map-and-mutate"><i class="fa fa-check"></i><b>5.2.2</b> Workflow: nested data, map and mutate</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ch-05.html"><a href="ch-05.html#string-manipulations"><i class="fa fa-check"></i><b>5.3</b> String Manipulations</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ch-05.html"><a href="ch-05.html#introduction-to-strings"><i class="fa fa-check"></i><b>5.3.1</b> Introduction to strings</a></li>
<li class="chapter" data-level="5.3.2" data-path="ch-05.html"><a href="ch-05.html#matching-and-extracting-patterns"><i class="fa fa-check"></i><b>5.3.2</b> Matching and extracting patterns</a></li>
<li class="chapter" data-level="5.3.3" data-path="ch-05.html"><a href="ch-05.html#advanced-example"><i class="fa fa-check"></i><b>5.3.3</b> Advanced example</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ch-05.html"><a href="ch-05.html#web-scraping-in-a-nut-shell"><i class="fa fa-check"></i><b>5.4</b> Web-scraping in a nut-shell</a></li>
<li class="chapter" data-level="5.5" data-path="ch-05.html"><a href="ch-05.html#tidyverses-filter-and-select"><i class="fa fa-check"></i><b>5.5</b> Tidyverse’s filter and select</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="ch-05.html"><a href="ch-05.html#introduction-4"><i class="fa fa-check"></i><b>5.5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.5.2" data-path="ch-05.html"><a href="ch-05.html#select"><i class="fa fa-check"></i><b>5.5.2</b> Select()</a></li>
<li class="chapter" data-level="5.5.3" data-path="ch-05.html"><a href="ch-05.html#filter"><i class="fa fa-check"></i><b>5.5.3</b> Filter()</a></li>
<li class="chapter" data-level="5.5.4" data-path="ch-05.html"><a href="ch-05.html#exercises"><i class="fa fa-check"></i><b>5.5.4</b> Exercises</a></li>
<li class="chapter" data-level="5.5.5" data-path="ch-05.html"><a href="ch-05.html#solutions"><i class="fa fa-check"></i><b>5.5.5</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="ch-05.html"><a href="ch-05.html#preparing-data-for-ggplot"><i class="fa fa-check"></i><b>5.6</b> Preparing data for ggplot()</a></li>
<li class="chapter" data-level="5.7" data-path="ch-05.html"><a href="ch-05.html#base-r-functions"><i class="fa fa-check"></i><b>5.7</b> Base R functions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-06.html"><a href="ch-06.html"><i class="fa fa-check"></i><b>6</b> Supervised Machine Learning I</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch-06.html"><a href="ch-06.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ch-06.html"><a href="ch-06.html#learning-objectives-1"><i class="fa fa-check"></i><b>6.1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="6.1.2" data-path="ch-06.html"><a href="ch-06.html#important-points-from-the-lecture-1"><i class="fa fa-check"></i><b>6.1.2</b> Important points from the lecture</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ch-06.html"><a href="ch-06.html#tutorial-4"><i class="fa fa-check"></i><b>6.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ch-06.html"><a href="ch-06.html#linear-regression"><i class="fa fa-check"></i><b>6.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="6.2.2" data-path="ch-06.html"><a href="ch-06.html#k-nearest-neighbours"><i class="fa fa-check"></i><b>6.2.2</b> K-nearest neighbours</a></li>
<li class="chapter" data-level="6.2.3" data-path="ch-06.html"><a href="ch-06.html#essential-methods-for-the-modelling-process"><i class="fa fa-check"></i><b>6.2.3</b> Essential methods for the modelling process</a></li>
<li class="chapter" data-level="6.2.4" data-path="ch-06.html"><a href="ch-06.html#bonus"><i class="fa fa-check"></i><b>6.2.4</b> Bonus</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ch-06.html"><a href="ch-06.html#exercise-5"><i class="fa fa-check"></i><b>6.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-07.html"><a href="ch-07.html"><i class="fa fa-check"></i><b>7</b> Supervised Machine Learning II</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ch-07.html"><a href="ch-07.html#introduction-6"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ch-07.html"><a href="ch-07.html#leaerning-objectives"><i class="fa fa-check"></i><b>7.1.1</b> Leaerning objectives</a></li>
<li class="chapter" data-level="7.1.2" data-path="ch-07.html"><a href="ch-07.html#key-points-from-the-lecture"><i class="fa fa-check"></i><b>7.1.2</b> Key points from the lecture</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ch-07.html"><a href="ch-07.html#tutorial-5"><i class="fa fa-check"></i><b>7.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ch-07.html"><a href="ch-07.html#model-training-and-the-loss-function"><i class="fa fa-check"></i><b>7.2.1</b> Model training and the loss function</a></li>
<li class="chapter" data-level="7.2.2" data-path="ch-07.html"><a href="ch-07.html#putting-it-all-together"><i class="fa fa-check"></i><b>7.2.2</b> Putting it all together</a></li>
<li class="chapter" data-level="7.2.3" data-path="ch-07.html"><a href="ch-07.html#model-evaluation"><i class="fa fa-check"></i><b>7.2.3</b> Model evaluation</a></li>
<li class="chapter" data-level="7.2.4" data-path="ch-07.html"><a href="ch-07.html#model-interpretation"><i class="fa fa-check"></i><b>7.2.4</b> Model interpretation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ch-07.html"><a href="ch-07.html#exercise-6"><i class="fa fa-check"></i><b>7.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch-08.html"><a href="ch-08.html"><i class="fa fa-check"></i><b>8</b> Application 1: Variable selection</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ch-08.html"><a href="ch-08.html#introduction-7"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="ch-08.html"><a href="ch-08.html#application"><i class="fa fa-check"></i><b>8.2</b> Application</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="ch-08.html"><a href="ch-08.html#warm-up-1-nested-for-loop"><i class="fa fa-check"></i><b>8.2.1</b> Warm-up 1: Nested for-loop</a></li>
<li class="chapter" data-level="8.2.2" data-path="ch-08.html"><a href="ch-08.html#warm-up-2-find-the-best-single-predictor"><i class="fa fa-check"></i><b>8.2.2</b> Warm-up 2: Find the best single predictor</a></li>
<li class="chapter" data-level="8.2.3" data-path="ch-08.html"><a href="ch-08.html#full-stepwise-regression"><i class="fa fa-check"></i><b>8.2.3</b> Full stepwise regression</a></li>
<li class="chapter" data-level="8.2.4" data-path="ch-08.html"><a href="ch-08.html#bonus-stepwise-regression-out-of-the-box"><i class="fa fa-check"></i><b>8.2.4</b> Bonus: Stepwise regression out-of-the-box</a></li>
<li class="chapter" data-level="8.2.5" data-path="ch-08.html"><a href="ch-08.html#bonus-best-subset-selection"><i class="fa fa-check"></i><b>8.2.5</b> Bonus: Best Subset Selection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-09.html"><a href="ch-09.html"><i class="fa fa-check"></i><b>9</b> Supervised Neural Networks I</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ch-09.html"><a href="ch-09.html#introduction-8"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ch-09.html"><a href="ch-09.html#learning-objectives-2"><i class="fa fa-check"></i><b>9.1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="9.1.2" data-path="ch-09.html"><a href="ch-09.html#important-points-from-the-lecture-2"><i class="fa fa-check"></i><b>9.1.2</b> Important points from the lecture</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ch-09.html"><a href="ch-09.html#tutorial-6"><i class="fa fa-check"></i><b>9.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ch-09.html"><a href="ch-09.html#set-up"><i class="fa fa-check"></i><b>9.2.1</b> Set-up</a></li>
<li class="chapter" data-level="9.2.2" data-path="ch-09.html"><a href="ch-09.html#keras-for-linear-models"><i class="fa fa-check"></i><b>9.2.2</b> Keras for linear models</a></li>
<li class="chapter" data-level="9.2.3" data-path="ch-09.html"><a href="ch-09.html#tuning-learning-rate"><i class="fa fa-check"></i><b>9.2.3</b> Tuning learning rate</a></li>
<li class="chapter" data-level="9.2.4" data-path="ch-09.html"><a href="ch-09.html#logistic-regression"><i class="fa fa-check"></i><b>9.2.4</b> Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ch-09.html"><a href="ch-09.html#exercise-7"><i class="fa fa-check"></i><b>9.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch-10.html"><a href="ch-10.html"><i class="fa fa-check"></i><b>10</b> Supervised Neural Networks II</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch-10.html"><a href="ch-10.html#introduction-9"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="ch-10.html"><a href="ch-10.html#learning-objectives-3"><i class="fa fa-check"></i><b>10.1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="10.1.2" data-path="ch-10.html"><a href="ch-10.html#important-points-from-the-lecture-3"><i class="fa fa-check"></i><b>10.1.2</b> Important points from the lecture</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="ch-10.html"><a href="ch-10.html#tutorial-7"><i class="fa fa-check"></i><b>10.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="ch-10.html"><a href="ch-10.html#import-libraries-1"><i class="fa fa-check"></i><b>10.2.1</b> Import libraries</a></li>
<li class="chapter" data-level="10.2.2" data-path="ch-10.html"><a href="ch-10.html#construct-a-toy-dataset"><i class="fa fa-check"></i><b>10.2.2</b> Construct a toy dataset</a></li>
<li class="chapter" data-level="10.2.3" data-path="ch-10.html"><a href="ch-10.html#build-and-train-nn"><i class="fa fa-check"></i><b>10.2.3</b> Build and train NN</a></li>
<li class="chapter" data-level="10.2.4" data-path="ch-10.html"><a href="ch-10.html#model-performance"><i class="fa fa-check"></i><b>10.2.4</b> Model performance</a></li>
<li class="chapter" data-level="10.2.5" data-path="ch-10.html"><a href="ch-10.html#influence-of-nn-architecture"><i class="fa fa-check"></i><b>10.2.5</b> Influence of NN architecture</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="ch-10.html"><a href="ch-10.html#exercise-8"><i class="fa fa-check"></i><b>10.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch-11.html"><a href="ch-11.html"><i class="fa fa-check"></i><b>11</b> Application 2: Neural Networks and Hyperparameter Tuning</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ch-11.html"><a href="ch-11.html#introduction-10"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="ch-11.html"><a href="ch-11.html#learning-goals"><i class="fa fa-check"></i><b>11.1.1</b> Learning Goals</a></li>
<li class="chapter" data-level="11.1.2" data-path="ch-11.html"><a href="ch-11.html#key-points-from-previous-lectures"><i class="fa fa-check"></i><b>11.1.2</b> Key Points from Previous Lectures</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="ch-11.html"><a href="ch-11.html#application-1"><i class="fa fa-check"></i><b>11.2</b> Application</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ch-11.html"><a href="ch-11.html#problem-statement"><i class="fa fa-check"></i><b>11.2.1</b> Problem Statement</a></li>
<li class="chapter" data-level="11.2.2" data-path="ch-11.html"><a href="ch-11.html#data-preparation"><i class="fa fa-check"></i><b>11.2.2</b> Data preparation</a></li>
<li class="chapter" data-level="11.2.3" data-path="ch-11.html"><a href="ch-11.html#center-and-scale"><i class="fa fa-check"></i><b>11.2.3</b> Center and scale</a></li>
<li class="chapter" data-level="11.2.4" data-path="ch-11.html"><a href="ch-11.html#building-a-simple-model-with-keras-subtask-1"><i class="fa fa-check"></i><b>11.2.4</b> Building a simple model with keras ( SubTask 1)</a></li>
<li class="chapter" data-level="11.2.5" data-path="ch-11.html"><a href="ch-11.html#cross-validation"><i class="fa fa-check"></i><b>11.2.5</b> Cross validation</a></li>
<li class="chapter" data-level="11.2.6" data-path="ch-11.html"><a href="ch-11.html#parameter-tuning"><i class="fa fa-check"></i><b>11.2.6</b> Parameter Tuning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch-12.html"><a href="ch-12.html"><i class="fa fa-check"></i><b>12</b> Supervised Deep Learning I</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ch-12.html"><a href="ch-12.html#introduction-11"><i class="fa fa-check"></i><b>12.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="ch-12.html"><a href="ch-12.html#learning-objectives-4"><i class="fa fa-check"></i><b>12.1.1</b> Learning objectives</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="ch-12.html"><a href="ch-12.html#tutorial-8"><i class="fa fa-check"></i><b>12.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ch-12.html"><a href="ch-12.html#building-blocks-of-cnns"><i class="fa fa-check"></i><b>12.2.1</b> Building Blocks of CNNs</a></li>
<li class="chapter" data-level="12.2.2" data-path="ch-12.html"><a href="ch-12.html#build-the-model"><i class="fa fa-check"></i><b>12.2.2</b> Build the model</a></li>
<li class="chapter" data-level="12.2.3" data-path="ch-12.html"><a href="ch-12.html#compile-and-train-the-model"><i class="fa fa-check"></i><b>12.2.3</b> Compile and train the model</a></li>
<li class="chapter" data-level="12.2.4" data-path="ch-12.html"><a href="ch-12.html#reduce-overfitting"><i class="fa fa-check"></i><b>12.2.4</b> Reduce Overfitting</a></li>
<li class="chapter" data-level="12.2.5" data-path="ch-12.html"><a href="ch-12.html#visualizing-a-cnn"><i class="fa fa-check"></i><b>12.2.5</b> Visualizing a CNN</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ch-12.html"><a href="ch-12.html#exercise-9"><i class="fa fa-check"></i><b>12.3</b> Exercise</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ch-12.html"><a href="ch-12.html#import-libraries-and-data"><i class="fa fa-check"></i><b>12.3.1</b> Import libraries and data</a></li>
<li class="chapter" data-level="12.3.2" data-path="ch-12.html"><a href="ch-12.html#tasks"><i class="fa fa-check"></i><b>12.3.2</b> Tasks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch-13.html"><a href="ch-13.html"><i class="fa fa-check"></i><b>13</b> Supervised Deep Learning II</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch-13.html"><a href="ch-13.html#introduction-12"><i class="fa fa-check"></i><b>13.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ch-13.html"><a href="ch-13.html#learning-objectives-5"><i class="fa fa-check"></i><b>13.1.1</b> Learning objectives</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="ch-13.html"><a href="ch-13.html#tutorial-9"><i class="fa fa-check"></i><b>13.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ch-13.html"><a href="ch-13.html#dataset"><i class="fa fa-check"></i><b>13.2.1</b> Dataset</a></li>
<li class="chapter" data-level="13.2.2" data-path="ch-13.html"><a href="ch-13.html#naive-models-old-world"><i class="fa fa-check"></i><b>13.2.2</b> Naive models (Old World)</a></li>
<li class="chapter" data-level="13.2.3" data-path="ch-13.html"><a href="ch-13.html#neural-networks-new-world"><i class="fa fa-check"></i><b>13.2.3</b> Neural Networks (New World)</a></li>
<li class="chapter" data-level="13.2.4" data-path="ch-13.html"><a href="ch-13.html#model-comparison"><i class="fa fa-check"></i><b>13.2.4</b> Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ch-13.html"><a href="ch-13.html#exercise-10"><i class="fa fa-check"></i><b>13.3</b> Exercise</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ch-13.html"><a href="ch-13.html#import-libraries-2"><i class="fa fa-check"></i><b>13.3.1</b> Import libraries</a></li>
<li class="chapter" data-level="13.3.2" data-path="ch-13.html"><a href="ch-13.html#load-data"><i class="fa fa-check"></i><b>13.3.2</b> Load data</a></li>
<li class="chapter" data-level="13.3.3" data-path="ch-13.html"><a href="ch-13.html#preprocess-ndvi-images"><i class="fa fa-check"></i><b>13.3.3</b> Preprocess NDVI images</a></li>
<li class="chapter" data-level="13.3.4" data-path="ch-13.html"><a href="ch-13.html#part-1"><i class="fa fa-check"></i><b>13.3.4</b> Part 1</a></li>
<li class="chapter" data-level="13.3.5" data-path="ch-13.html"><a href="ch-13.html#part-2"><i class="fa fa-check"></i><b>13.3.5</b> Part 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Environmental Systems Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch-05" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Catch-up</h1>
<p>This chapter is a review of various applications and functions of the code we have covered so far.</p>
<div id="loops-in-r" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Loops in R</h2>
<div id="some-simple-examples" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Some simple examples</h3>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="ch-05.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simple example with a for loop </span></span>
<span id="cb447-2"><a href="ch-05.html#cb447-2" aria-hidden="true" tabindex="-1"></a><span class="do">## convert all the names to uppercase letters </span></span>
<span id="cb447-3"><a href="ch-05.html#cb447-3" aria-hidden="true" tabindex="-1"></a>names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;Maria&#39;</span>,<span class="st">&#39;Thomas&#39;</span>,<span class="st">&#39;Andreas&#39;</span>)</span>
<span id="cb447-4"><a href="ch-05.html#cb447-4" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize uppercase names</span></span>
<span id="cb447-5"><a href="ch-05.html#cb447-5" aria-hidden="true" tabindex="-1"></a>upper_names <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">length</span>(names))</span>
<span id="cb447-6"><a href="ch-05.html#cb447-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-7"><a href="ch-05.html#cb447-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(names)){</span>
<span id="cb447-8"><a href="ch-05.html#cb447-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#convert to uppercase </span></span>
<span id="cb447-9"><a href="ch-05.html#cb447-9" aria-hidden="true" tabindex="-1"></a>    upper_name <span class="ot">=</span> <span class="fu">toupper</span>(names[i])</span>
<span id="cb447-10"><a href="ch-05.html#cb447-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#add it to upper_names </span></span>
<span id="cb447-11"><a href="ch-05.html#cb447-11" aria-hidden="true" tabindex="-1"></a>    upper_names[i] <span class="ot">=</span> upper_name</span>
<span id="cb447-12"><a href="ch-05.html#cb447-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb447-13"><a href="ch-05.html#cb447-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-14"><a href="ch-05.html#cb447-14" aria-hidden="true" tabindex="-1"></a>upper_names</span></code></pre></div>
<pre><code>## [1] &quot;MARIA&quot;   &quot;THOMAS&quot;  &quot;ANDREAS&quot;</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="ch-05.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="co"># equivalent operation with the lapply</span></span>
<span id="cb449-2"><a href="ch-05.html#cb449-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(names,toupper)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;MARIA&quot;
## 
## [[2]]
## [1] &quot;THOMAS&quot;
## 
## [[3]]
## [1] &quot;ANDREAS&quot;</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="ch-05.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simple example with a while loop</span></span>
<span id="cb451-2"><a href="ch-05.html#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate the sum of the values </span></span>
<span id="cb451-3"><a href="ch-05.html#cb451-3" aria-hidden="true" tabindex="-1"></a>values <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)</span>
<span id="cb451-4"><a href="ch-05.html#cb451-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-5"><a href="ch-05.html#cb451-5" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize index</span></span>
<span id="cb451-6"><a href="ch-05.html#cb451-6" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb451-7"><a href="ch-05.html#cb451-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-8"><a href="ch-05.html#cb451-8" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize sum</span></span>
<span id="cb451-9"><a href="ch-05.html#cb451-9" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb451-10"><a href="ch-05.html#cb451-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb451-11"><a href="ch-05.html#cb451-11" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (i <span class="sc">&lt;=</span> <span class="dv">3</span>){<span class="co"># for as long as i is smaller or equal to 3, execute the code below</span></span>
<span id="cb451-12"><a href="ch-05.html#cb451-12" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb451-13"><a href="ch-05.html#cb451-13" aria-hidden="true" tabindex="-1"></a>   <span class="co"># add the next value to the sum </span></span>
<span id="cb451-14"><a href="ch-05.html#cb451-14" aria-hidden="true" tabindex="-1"></a>   sum <span class="ot">=</span> sum <span class="sc">+</span> values[i]</span>
<span id="cb451-15"><a href="ch-05.html#cb451-15" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb451-16"><a href="ch-05.html#cb451-16" aria-hidden="true" tabindex="-1"></a>   <span class="co">#update the index</span></span>
<span id="cb451-17"><a href="ch-05.html#cb451-17" aria-hidden="true" tabindex="-1"></a>   i <span class="ot">&lt;-</span> i<span class="sc">+</span><span class="dv">1</span> </span>
<span id="cb451-18"><a href="ch-05.html#cb451-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb451-19"><a href="ch-05.html#cb451-19" aria-hidden="true" tabindex="-1"></a><span class="co">#print the sum</span></span>
<span id="cb451-20"><a href="ch-05.html#cb451-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sum = &quot;</span>, sum)</span></code></pre></div>
<pre><code>## Sum =  12</code></pre>
<p><strong>For loops with breaks:</strong></p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="ch-05.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Print all the numbers until the number 10 appers. Then stop the loop</span></span>
<span id="cb453-2"><a href="ch-05.html#cb453-2" aria-hidden="true" tabindex="-1"></a>values <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">18</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">13</span>)</span>
<span id="cb453-3"><a href="ch-05.html#cb453-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-4"><a href="ch-05.html#cb453-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(values)){</span>
<span id="cb453-5"><a href="ch-05.html#cb453-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb453-6"><a href="ch-05.html#cb453-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print value</span></span>
<span id="cb453-7"><a href="ch-05.html#cb453-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(values[i],<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb453-8"><a href="ch-05.html#cb453-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb453-9"><a href="ch-05.html#cb453-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#check the printed number</span></span>
<span id="cb453-10"><a href="ch-05.html#cb453-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (values[i] <span class="sc">==</span> <span class="dv">10</span>){</span>
<span id="cb453-11"><a href="ch-05.html#cb453-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span> <span class="co"># if the number is 10 stop the loop</span></span>
<span id="cb453-12"><a href="ch-05.html#cb453-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb453-13"><a href="ch-05.html#cb453-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 3 
## 1 
## 5 
## 18 
## 10</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="ch-05.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="co"># while true loop</span></span>
<span id="cb455-2"><a href="ch-05.html#cb455-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Print all the numbers until the number 10 appers. Then stop the loop</span></span>
<span id="cb455-3"><a href="ch-05.html#cb455-3" aria-hidden="true" tabindex="-1"></a>values <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">18</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">13</span>)</span>
<span id="cb455-4"><a href="ch-05.html#cb455-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-5"><a href="ch-05.html#cb455-5" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize index</span></span>
<span id="cb455-6"><a href="ch-05.html#cb455-6" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb455-7"><a href="ch-05.html#cb455-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-8"><a href="ch-05.html#cb455-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>){<span class="co"># It always gets inside and executes the code. The loop only stops when the break starement is encountered</span></span>
<span id="cb455-9"><a href="ch-05.html#cb455-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb455-10"><a href="ch-05.html#cb455-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print value</span></span>
<span id="cb455-11"><a href="ch-05.html#cb455-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(values[i],<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb455-12"><a href="ch-05.html#cb455-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb455-13"><a href="ch-05.html#cb455-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#check the printed number</span></span>
<span id="cb455-14"><a href="ch-05.html#cb455-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (values[i] <span class="sc">==</span> <span class="dv">10</span>){</span>
<span id="cb455-15"><a href="ch-05.html#cb455-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span> <span class="co"># if the number is 10 stop the loop</span></span>
<span id="cb455-16"><a href="ch-05.html#cb455-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb455-17"><a href="ch-05.html#cb455-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb455-18"><a href="ch-05.html#cb455-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#otherwise update the index and continue</span></span>
<span id="cb455-19"><a href="ch-05.html#cb455-19" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb455-20"><a href="ch-05.html#cb455-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 3 
## 1 
## 5 
## 18 
## 10</code></pre>
</div>
<div id="nested-loops" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Nested loops</h3>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="ch-05.html#cb457-1" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="at">nrow =</span> <span class="dv">2</span> ,<span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb457-2"><a href="ch-05.html#cb457-2" aria-hidden="true" tabindex="-1"></a>values</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="ch-05.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nested loops</span></span>
<span id="cb459-2"><a href="ch-05.html#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="do">## find the sum of the values per column</span></span>
<span id="cb459-3"><a href="ch-05.html#cb459-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-4"><a href="ch-05.html#cb459-4" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize the sums of the columns to zero</span></span>
<span id="cb459-5"><a href="ch-05.html#cb459-5" aria-hidden="true" tabindex="-1"></a>col_sum <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">ncol</span>(values))</span>
<span id="cb459-6"><a href="ch-05.html#cb459-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-7"><a href="ch-05.html#cb459-7" aria-hidden="true" tabindex="-1"></a><span class="co">#iterate over the columns</span></span>
<span id="cb459-8"><a href="ch-05.html#cb459-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(values)){ </span>
<span id="cb459-9"><a href="ch-05.html#cb459-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#iterate over the rows for each column</span></span>
<span id="cb459-10"><a href="ch-05.html#cb459-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(values)){</span>
<span id="cb459-11"><a href="ch-05.html#cb459-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">#calculate the sum of the jth column by adding the values of each row (of the jth column)</span></span>
<span id="cb459-12"><a href="ch-05.html#cb459-12" aria-hidden="true" tabindex="-1"></a>        col_sum[j] <span class="ot">&lt;-</span> col_sum[j] <span class="sc">+</span> values[i,j]</span>
<span id="cb459-13"><a href="ch-05.html#cb459-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb459-14"><a href="ch-05.html#cb459-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb459-15"><a href="ch-05.html#cb459-15" aria-hidden="true" tabindex="-1"></a>col_sum</span></code></pre></div>
<pre><code>## [1]  3  7 11</code></pre>
</div>
<div id="exercise-4" class="section level3" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Exercise</h3>
<p>Create a for loop program that estimates the sum of each row. However it has to take into account only the numbers than are greater that 2. If you get it right, you should come up with 3 for the first row and 15 for the second row.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="ch-05.html#cb461-1" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">6</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb461-2"><a href="ch-05.html#cb461-2" aria-hidden="true" tabindex="-1"></a>values</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    3    1    2
## [2,]    4    5    6</code></pre>
</div>
</div>
<div id="functional-programming-using-purr" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Functional programming using purr</h2>
<p><code>purrr</code> is tidyverse’s version of the base R’s apply (lapply(), sapply(),..etc) functions for iterating over objects and lists. But <code>purrr</code> is a lot more powerful than that! While the main data-type used in dplyr is the dataframe, for <code>purrr</code> it is lists. Let us look at a few map functions and how they can be used to replace apply functions / loops in R. Then we look at nested data handling and a fairly realistic workflow. Splitting the data based on some column, fitting multiple models to each split, and extracting the R^2 for these models. Let us first load in the required libraries.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="ch-05.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;tidyverse&#39;</span>)</span>
<span id="cb463-2"><a href="ch-05.html#cb463-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;datasets&#39;</span>)</span>
<span id="cb463-3"><a href="ch-05.html#cb463-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span></code></pre></div>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="ch-05.html#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s define a vector with values from 1 to 10</span></span>
<span id="cb464-2"><a href="ch-05.html#cb464-2" aria-hidden="true" tabindex="-1"></a>vector_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) </span>
<span id="cb464-3"><a href="ch-05.html#cb464-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-4"><a href="ch-05.html#cb464-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Next we define a function to compute the square of a number</span></span>
<span id="cb464-5"><a href="ch-05.html#cb464-5" aria-hidden="true" tabindex="-1"></a>square <span class="ot">&lt;-</span> <span class="cf">function</span>(.x){</span>
<span id="cb464-6"><a href="ch-05.html#cb464-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (.x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb464-7"><a href="ch-05.html#cb464-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb464-8"><a href="ch-05.html#cb464-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-9"><a href="ch-05.html#cb464-9" aria-hidden="true" tabindex="-1"></a><span class="co"># What happens if we apply our function to vector_1? Of course, it squares every element!</span></span>
<span id="cb464-10"><a href="ch-05.html#cb464-10" aria-hidden="true" tabindex="-1"></a>vector_1</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="ch-05.html#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">square</span>(vector_1)</span></code></pre></div>
<pre><code>##  [1]   1   4   9  16  25  36  49  64  81 100</code></pre>
<p>The same can be done using <code>map()</code> functions, as there is nothing wrong with them, but the output format we get, can become a little ambiguous (recall <code>sapply()</code>), and the function syntax can become a little inconsistent. The input to a map() function is either: list, vector, or a dataframe. For lists and vectors the iteration is carried over the elements of the list/vector. For dataframes, the iteration is carried over the columns of the dataframe. Here’s a quick overview over the different functions with their outputs and object classes below as code. Note that <code>.x</code> stands for the input object and <code>.f</code> for the function that you want to apply:</p>
<ul>
<li><code>map(.x, .f)</code> is the main mapping function and returns a list</li>
<li><code>map_df(.x, .f)</code> takes data frame as input and returns one</li>
<li><code>map_dbl(.x, .f)</code> returns a numeric (double) vector</li>
<li><code>map_chr(.x, .f)</code> returns a character vector</li>
<li><code>map_lgl(.x, .f)</code> returns a logical vector</li>
</ul>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="ch-05.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(vector_1, square)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 4
## 
## [[3]]
## [1] 9
## 
## [[4]]
## [1] 16
## 
## [[5]]
## [1] 25
## 
## [[6]]
## [1] 36
## 
## [[7]]
## [1] 49
## 
## [[8]]
## [1] 64
## 
## [[9]]
## [1] 81
## 
## [[10]]
## [1] 100</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="ch-05.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_df</span>(<span class="fu">as.data.frame</span>(vector_1), square)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 1
##    vector_1
##       &lt;dbl&gt;
##  1        1
##  2        4
##  3        9
##  4       16
##  5       25
##  6       36
##  7       49
##  8       64
##  9       81
## 10      100</code></pre>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="ch-05.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(vector_1, square)</span></code></pre></div>
<pre><code>##  [1]   1   4   9  16  25  36  49  64  81 100</code></pre>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="ch-05.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_chr</span>(vector_1, square)</span></code></pre></div>
<pre><code>##  [1] &quot;1.000000&quot;   &quot;4.000000&quot;   &quot;9.000000&quot;   &quot;16.000000&quot;  &quot;25.000000&quot; 
##  [6] &quot;36.000000&quot;  &quot;49.000000&quot;  &quot;64.000000&quot;  &quot;81.000000&quot;  &quot;100.000000&quot;</code></pre>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="ch-05.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map_lgl(vector_1, square) - useless because numbers except 1 and 0 cannot be turned into logic operators</span></span></code></pre></div>
<div id="shortcuts-in-a-purrr-function" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Shortcuts in a <code>purrr</code> function</h3>
<p>We can also define inline functions using the <code>~</code> syntax. This means that you can directly define a function that has to be applied to your input object(s) without having to define it separately. Note that this allows you to combine multiple input variables as you whish. For example, if you want to multiply <code>x</code> and <code>y</code>, you would define the function as <code>~(.x * .y)</code>. In the list below, the multiplication can be swapped arbitrarily and is thus any operation is generally referred to by using <code>operation</code>. Also note that for multiple inputs, you need to adjust the <code>map()</code> function to <code>map2()</code> or <code>pmap()</code> Play around with the codes below to get a feeling for this formulation! Here are some examples explained:</p>
<ul>
<li><code>~ operation .</code> becomes <code>function(x) x.</code>: map(input, ~ (2 + . )) adds 2 to every element in your input</li>
<li><code>~ .x operation .y</code> becomes <code>function(x, y) .x .y.</code>: map2(input1, input2, ~ (.x + .y )) means every input1 element is added to the respective input2 element.</li>
<li><code>~ ..1 operation ..2 operation ..etc</code> becomes <code>function(1, 2, etc)</code>: pmap(list(input1, input2, input3), ~ (..3 + ..1 - ..2)) for example adds the first element in input1 to and subtracts the first element in input2 from the first element in input 3. The same is done for the second element of each input and so on. In other words the elements of the list or vector you give as input are paired up depending on their position. Note that <code>pmap()</code> requires a list for multiple inputs.</li>
</ul>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="ch-05.html#cb477-1" aria-hidden="true" tabindex="-1"></a>vector_2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">5</span>,<span class="dv">10</span>)       <span class="co"># Vector holding 10 elements which are a 5</span></span>
<span id="cb477-2"><a href="ch-05.html#cb477-2" aria-hidden="true" tabindex="-1"></a>vector_3 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>)   <span class="co"># Vector holding elements from 1 to 10 with 1 as interval (same as vector_1)</span></span>
<span id="cb477-3"><a href="ch-05.html#cb477-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-4"><a href="ch-05.html#cb477-4" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(vector_1, <span class="sc">~</span> (.x<span class="sc">^</span><span class="dv">2</span>)) <span class="co"># Does the same as above using our pre-defined square() function</span></span></code></pre></div>
<pre><code>##  [1]   1   4   9  16  25  36  49  64  81 100</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="ch-05.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(vector_1, <span class="sc">~</span> (.x <span class="sc">+</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##  [1]  2  3  4  5  6  7  8  9 10 11</code></pre>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="ch-05.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map2_dbl</span>(vector_1, vector_2, <span class="sc">~</span>(.x <span class="sc">*</span> .y))</span></code></pre></div>
<pre><code>##  [1]  5 10 15 20 25 30 35 40 45 50</code></pre>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="ch-05.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pmap_dbl</span>(<span class="fu">list</span>(vector_1, vector_2, vector_3), <span class="sc">~</span>(..<span class="dv">1</span><span class="sc">*</span>..<span class="dv">2</span> <span class="sc">+</span> ..<span class="dv">3</span>))</span></code></pre></div>
<pre><code>##  [1]  6 12 18 24 30 36 42 48 54 60</code></pre>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="ch-05.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pmap_dbl</span>(<span class="fu">list</span>(vector_1, vector_2, <span class="dv">1</span>), <span class="sc">~</span>(..<span class="dv">1</span><span class="sc">*</span>..<span class="dv">2</span> <span class="sc">+</span> ..<span class="dv">3</span>)) <span class="co"># What if vector_3 is a 1? It simply takes 1 for every operation!</span></span></code></pre></div>
<pre><code>##  [1]  6 11 16 21 26 31 36 41 46 51</code></pre>
</div>
<div id="workflow-nested-data-map-and-mutate" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Workflow: nested data, map and mutate</h3>
<p>Now let us consider workflow with the iris dataset from R. We want to fit a linear model to predict the the <code>Sepal.length</code> as a function of all the other features in the dataset. But we want a different linear model for each type of species. This is pretty realistic as one would have different species to have different “models” for their sepal length. After loading the data, let us first group all the rows in our dataframe by the Species. Then we can use the <code>nest()</code> function, which gives us a nested dataframe for each unique entry in the grouping column. The code below walks you through every step to access the R<sup>2</sup> values of different models and then in the end combines everything in one simple pipe. To have a in-depth look at these functionalities, look up the <a href="https://purrr.tidyverse.org/">purrr documentation</a>.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="ch-05.html#cb487-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> iris</span>
<span id="cb487-2"><a href="ch-05.html#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="ch-05.html#cb489-1" aria-hidden="true" tabindex="-1"></a>nested_iris <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span> <span class="fu">nest</span>()</span>
<span id="cb489-2"><a href="ch-05.html#cb489-2" aria-hidden="true" tabindex="-1"></a>nested_iris      <span class="co"># See that for every species there is a tibble defined </span></span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
## # Groups:   Species [3]
##   Species    data             
##   &lt;fct&gt;      &lt;list&gt;           
## 1 setosa     &lt;tibble [50 × 4]&gt;
## 2 versicolor &lt;tibble [50 × 4]&gt;
## 3 virginica  &lt;tibble [50 × 4]&gt;</code></pre>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="ch-05.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(nested_iris) <span class="co"># Each of these tibbles holds information on the other 4 variables for this species</span></span></code></pre></div>
<pre><code>## grouped_df [3 × 2] (S3: grouped_df/tbl_df/tbl/data.frame)
##  $ Species: Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 2 3
##  $ data   :List of 3
##   ..$ : tibble [50 × 4] (S3: tbl_df/tbl/data.frame)
##   .. ..$ Sepal.Length: num [1:50] 5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##   .. ..$ Sepal.Width : num [1:50] 3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##   .. ..$ Petal.Length: num [1:50] 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##   .. ..$ Petal.Width : num [1:50] 0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##   ..$ : tibble [50 × 4] (S3: tbl_df/tbl/data.frame)
##   .. ..$ Sepal.Length: num [1:50] 7 6.4 6.9 5.5 6.5 5.7 6.3 4.9 6.6 5.2 ...
##   .. ..$ Sepal.Width : num [1:50] 3.2 3.2 3.1 2.3 2.8 2.8 3.3 2.4 2.9 2.7 ...
##   .. ..$ Petal.Length: num [1:50] 4.7 4.5 4.9 4 4.6 4.5 4.7 3.3 4.6 3.9 ...
##   .. ..$ Petal.Width : num [1:50] 1.4 1.5 1.5 1.3 1.5 1.3 1.6 1 1.3 1.4 ...
##   ..$ : tibble [50 × 4] (S3: tbl_df/tbl/data.frame)
##   .. ..$ Sepal.Length: num [1:50] 6.3 5.8 7.1 6.3 6.5 7.6 4.9 7.3 6.7 7.2 ...
##   .. ..$ Sepal.Width : num [1:50] 3.3 2.7 3 2.9 3 3 2.5 2.9 2.5 3.6 ...
##   .. ..$ Petal.Length: num [1:50] 6 5.1 5.9 5.6 5.8 6.6 4.5 6.3 5.8 6.1 ...
##   .. ..$ Petal.Width : num [1:50] 2.5 1.9 2.1 1.8 2.2 2.1 1.7 1.8 1.8 2.5 ...
##  - attr(*, &quot;groups&quot;)= tibble [3 × 2] (S3: tbl_df/tbl/data.frame)
##   ..$ Species: Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 2 3
##   ..$ .rows  : list&lt;int&gt; [1:3] 
##   .. ..$ : int 1
##   .. ..$ : int 2
##   .. ..$ : int 3
##   .. ..@ ptype: int(0) 
##   ..- attr(*, &quot;.drop&quot;)= logi TRUE</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="ch-05.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(nested_iris<span class="sc">$</span>data, dim) <span class="co"># Display the dimension of every data frame saved in nested_iris (50 entries for 4 features)</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] 50  4
## 
## [[2]]
## [1] 50  4
## 
## [[3]]
## [1] 50  4</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="ch-05.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s use the nested data frame to create a data frame holding only the linear models:</span></span>
<span id="cb495-2"><a href="ch-05.html#cb495-2" aria-hidden="true" tabindex="-1"></a>list_linear_models <span class="ot">&lt;-</span> <span class="fu">map</span>(nested_iris<span class="sc">$</span>data,      <span class="co"># Give the list of data frames as input to map</span></span>
<span id="cb495-3"><a href="ch-05.html#cb495-3" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">~</span><span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> .,  <span class="co"># For every data frame, create a linear model with lm() where </span></span>
<span id="cb495-4"><a href="ch-05.html#cb495-4" aria-hidden="true" tabindex="-1"></a>                                                 <span class="co"># Sepal.Length is the response and all other variables predictors</span></span>
<span id="cb495-5"><a href="ch-05.html#cb495-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> .x))            <span class="co"># The data for each linear model is simply the input .x, i.e. the df</span></span>
<span id="cb495-6"><a href="ch-05.html#cb495-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-7"><a href="ch-05.html#cb495-7" aria-hidden="true" tabindex="-1"></a>list_linear_models <span class="sc">%&gt;%</span> </span>
<span id="cb495-8"><a href="ch-05.html#cb495-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(summary) <span class="sc">%&gt;%</span>                               <span class="co"># Apply summary() on all linear models</span></span>
<span id="cb495-9"><a href="ch-05.html#cb495-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="st">&quot;r.squared&quot;</span>)                               <span class="co"># Extract the r.squared value of each linear model</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.5751375
## 
## [[2]]
## [1] 0.6050314
## 
## [[3]]
## [1] 0.7652193</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="ch-05.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we know how to create these models, so let&#39;s add them as a variable to our nested data frame</span></span>
<span id="cb497-2"><a href="ch-05.html#cb497-2" aria-hidden="true" tabindex="-1"></a>model_iris <span class="ot">&lt;-</span> nested_iris <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">linear_model =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(Sepal.Length<span class="sc">~</span>., <span class="at">data =</span> .x))) <span class="co"># To add models</span></span>
<span id="cb497-3"><a href="ch-05.html#cb497-3" aria-hidden="true" tabindex="-1"></a>model_iris <span class="ot">&lt;-</span> model_iris <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">summary =</span> <span class="fu">map</span>(linear_model, <span class="sc">~</span><span class="fu">summary</span>(.))) <span class="co"># To add summary of each model</span></span>
<span id="cb497-4"><a href="ch-05.html#cb497-4" aria-hidden="true" tabindex="-1"></a>model_iris</span></code></pre></div>
<pre><code>## # A tibble: 3 x 4
## # Groups:   Species [3]
##   Species    data              linear_model summary   
##   &lt;fct&gt;      &lt;list&gt;            &lt;list&gt;       &lt;list&gt;    
## 1 setosa     &lt;tibble [50 × 4]&gt; &lt;lm&gt;         &lt;smmry.lm&gt;
## 2 versicolor &lt;tibble [50 × 4]&gt; &lt;lm&gt;         &lt;smmry.lm&gt;
## 3 virginica  &lt;tibble [50 × 4]&gt; &lt;lm&gt;         &lt;smmry.lm&gt;</code></pre>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="ch-05.html#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Putting it all together and extracting the R^2 value for each linear model</span></span>
<span id="cb499-2"><a href="ch-05.html#cb499-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-3"><a href="ch-05.html#cb499-3" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span>                                                               <span class="co"># Use iris data frame</span></span>
<span id="cb499-4"><a href="ch-05.html#cb499-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span>                                                <span class="co"># Select variable to group by </span></span>
<span id="cb499-5"><a href="ch-05.html#cb499-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span>                                                           <span class="co"># Create nested df by groups </span></span>
<span id="cb499-6"><a href="ch-05.html#cb499-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">linear_model =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(Sepal.Length<span class="sc">~</span>., <span class="at">data =</span> .x))) <span class="sc">%&gt;%</span> <span class="co"># Create lm for each group</span></span>
<span id="cb499-7"><a href="ch-05.html#cb499-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">summary =</span> <span class="fu">map</span>(linear_model, <span class="sc">~</span><span class="fu">summary</span>(.))) <span class="sc">%&gt;%</span>                 <span class="co"># Create summary for each group</span></span>
<span id="cb499-8"><a href="ch-05.html#cb499-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rsq =</span> <span class="fu">map_dbl</span>(summary, <span class="st">&quot;r.squared&quot;</span>)) <span class="sc">%&gt;%</span>                      <span class="co"># Save r.squared from each lm as rsq</span></span>
<span id="cb499-9"><a href="ch-05.html#cb499-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(Species,rsq))                                               <span class="co"># Only pick Species and rsq to display</span></span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
## # Groups:   Species [3]
##   Species      rsq
##   &lt;fct&gt;      &lt;dbl&gt;
## 1 setosa     0.575
## 2 versicolor 0.605
## 3 virginica  0.765</code></pre>
</div>
</div>
<div id="string-manipulations" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> String Manipulations</h2>
<div id="introduction-to-strings" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Introduction to strings</h3>
<p>The <code>stringr</code> package offers a set of very handy tools to work with strings. In this document, we will show you how to do some basic string manipulations with `stringr. Further useful sources are the <a href="https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf">stringr cheathseet</a> and the Chapter 14 in the book <a href="https://r4ds.had.co.nz/strings.html">R for Data Science</a>.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="ch-05.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s load the package and save two srings</span></span>
<span id="cb501-2"><a href="ch-05.html#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb501-3"><a href="ch-05.html#cb501-3" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="st">&quot;A1 BC23 DEF456&quot;</span></span>
<span id="cb501-4"><a href="ch-05.html#cb501-4" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>,<span class="st">&quot;BC23&quot;</span>,<span class="st">&quot;DEF456&quot;</span>)</span>
<span id="cb501-5"><a href="ch-05.html#cb501-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-6"><a href="ch-05.html#cb501-6" aria-hidden="true" tabindex="-1"></a><span class="co"># String lengths</span></span>
<span id="cb501-7"><a href="ch-05.html#cb501-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(s1) <span class="co"># spacing counts </span></span></code></pre></div>
<pre><code>## [1] 14</code></pre>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="ch-05.html#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(s2) <span class="co"># returns length of each string vector</span></span></code></pre></div>
<pre><code>## [1] 2 4 6</code></pre>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="ch-05.html#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining strings</span></span>
<span id="cb505-2"><a href="ch-05.html#cb505-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>) </span></code></pre></div>
<pre><code>## [1] &quot;xy&quot;</code></pre>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="ch-05.html#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">&#39;p&#39;</span>,s2,<span class="st">&#39;q&#39;</span>) <span class="co"># works on each element of the string vector</span></span></code></pre></div>
<pre><code>## [1] &quot;pA1q&quot;     &quot;pBC23q&quot;   &quot;pDEF456q&quot;</code></pre>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="ch-05.html#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing lower/upper case</span></span>
<span id="cb509-2"><a href="ch-05.html#cb509-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_to_lower</span>(s1)</span></code></pre></div>
<pre><code>## [1] &quot;a1 bc23 def456&quot;</code></pre>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="ch-05.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_to_upper</span>(<span class="st">&quot;paradox? is this now lower or upper case?&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;PARADOX? IS THIS NOW LOWER OR UPPER CASE?&quot;</code></pre>
<p><code>str_sub()</code> is inclusive - they include the characters at both start and end positions. For example, <code>str_sub(string, 1, -1)</code> will return the complete substring, from the first character to the last.</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="ch-05.html#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(s1, <span class="dv">1</span>, <span class="dv">6</span>) <span class="co"># get a substing from 1st to 6th elements</span></span></code></pre></div>
<pre><code>## [1] &quot;A1 BC2&quot;</code></pre>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="ch-05.html#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(s2, <span class="dv">1</span>, <span class="dv">2</span>) <span class="co"># get substings from 1st to 2nd elements</span></span></code></pre></div>
<pre><code>## [1] &quot;A1&quot; &quot;BC&quot; &quot;DE&quot;</code></pre>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="ch-05.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(s1, <span class="dv">8</span>)  <span class="co"># get a substring from 8th element onwards</span></span></code></pre></div>
<pre><code>## [1] &quot; DEF456&quot;</code></pre>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="ch-05.html#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(s2, <span class="dv">2</span>)  <span class="co"># get substrings from 2nd element onwards</span></span></code></pre></div>
<pre><code>## [1] &quot;1&quot;     &quot;C23&quot;   &quot;EF456&quot;</code></pre>
<p><code>str_split(string, pattern,...)</code> allows to vectorise strings over pattern.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="ch-05.html#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_split</span>(s2, <span class="at">pattern =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;A1&quot;
## 
## [[2]]
## [1] &quot;BC23&quot;
## 
## [[3]]
## [1] &quot;DEF456&quot;</code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="ch-05.html#cb523-1" aria-hidden="true" tabindex="-1"></a>fruits <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb523-2"><a href="ch-05.html#cb523-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;apples and oranges and pears and bananas&quot;</span>,</span>
<span id="cb523-3"><a href="ch-05.html#cb523-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;pineapples and mangos and guavas&quot;</span>)</span>
<span id="cb523-4"><a href="ch-05.html#cb523-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-5"><a href="ch-05.html#cb523-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str_split</span>(fruits, <span class="at">pattern =</span> <span class="st">&quot; and &quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;apples&quot;  &quot;oranges&quot; &quot;pears&quot;   &quot;bananas&quot;
## 
## [[2]]
## [1] &quot;pineapples&quot; &quot;mangos&quot;     &quot;guavas&quot;</code></pre>
</div>
<div id="matching-and-extracting-patterns" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Matching and extracting patterns</h3>
<p><code>str_match(string, pattern,...)</code> returns the first pattern match found in each string, as a matrix with a column for each ( ) group in pattern. <code>str_match_all()</code> returns all matched patterns. The pattern can be a substring from the strinh vectors, or can be a generalized pattern to detect for example certain sequences of alphabetic and numeric characters. Please refer to this <a href="https://stringr.tidyverse.org/articles/regular-expressions.html">info page</a> for an introduction to pattern usages.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="ch-05.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect certain patterns in a vector of characters</span></span>
<span id="cb525-2"><a href="ch-05.html#cb525-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(s1, <span class="st">&#39;A&#39;</span>) <span class="co"># s1 is just one string!</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="ch-05.html#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(s2, <span class="st">&#39;A&#39;</span>) <span class="co"># s2 splitted s1 into three strings</span></span></code></pre></div>
<pre><code>## [1]  TRUE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="ch-05.html#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect substring (pattern)</span></span>
<span id="cb529-2"><a href="ch-05.html#cb529-2" aria-hidden="true" tabindex="-1"></a>pattern1 <span class="ot">=</span> <span class="st">&quot;BC&quot;</span> <span class="co"># substring as a pattern</span></span>
<span id="cb529-3"><a href="ch-05.html#cb529-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str_match</span>(s1, pattern1)</span></code></pre></div>
<pre><code>##      [,1]
## [1,] &quot;BC&quot;</code></pre>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="ch-05.html#cb531-1" aria-hidden="true" tabindex="-1"></a>pattern2 <span class="ot">=</span> <span class="st">&quot;([[:alpha:]]+)([[:digit:]]+)&quot;</span> <span class="co"># pattern2 = alphabetic characters + digits</span></span>
<span id="cb531-2"><a href="ch-05.html#cb531-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_match</span>(s1, pattern2)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,] &quot;A1&quot; &quot;A&quot;  &quot;1&quot;</code></pre>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="ch-05.html#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_match_all</span>(s1, pattern2)</span></code></pre></div>
<pre><code>## [[1]]
##      [,1]     [,2]  [,3] 
## [1,] &quot;A1&quot;     &quot;A&quot;   &quot;1&quot;  
## [2,] &quot;BC23&quot;   &quot;BC&quot;  &quot;23&quot; 
## [3,] &quot;DEF456&quot; &quot;DEF&quot; &quot;456&quot;</code></pre>
<p><code>str_extract(string, pattern,...)</code> returns the first pattern match found in each string, as a vector, <code>str_extract_all()</code> again returns all matched patterns.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="ch-05.html#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(s1, pattern2)</span></code></pre></div>
<pre><code>## [1] &quot;A1&quot;</code></pre>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="ch-05.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract_all</span>(s1, pattern2)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;A1&quot;     &quot;BC23&quot;   &quot;DEF456&quot;</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="ch-05.html#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="co"># an equivalent way using basic R:</span></span>
<span id="cb539-2"><a href="ch-05.html#cb539-2" aria-hidden="true" tabindex="-1"></a><span class="fu">regmatches</span>(s1, <span class="fu">gregexpr</span>(pattern2, s1)) </span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;A1&quot;     &quot;BC23&quot;   &quot;DEF456&quot;</code></pre>
<p><code>str_replace(string, pattern, replacement,...)</code> replaces matched patterns in a string. Alternatively, you can replace substrings by identifying the substrings with <code>str_sub()</code> and assigning into the results.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="ch-05.html#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_replace_all</span>(s1, <span class="st">&quot; &quot;</span>, <span class="st">&quot;-&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;A1-BC23-DEF456&quot;</code></pre>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="ch-05.html#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(s1, <span class="dv">1</span>, <span class="dv">2</span>) <span class="ot">&lt;-</span> <span class="st">&quot;XX&quot;</span> <span class="co"># Replace the first two positions in s1</span></span>
<span id="cb543-2"><a href="ch-05.html#cb543-2" aria-hidden="true" tabindex="-1"></a>s1</span></code></pre></div>
<pre><code>## [1] &quot;XX BC23 DEF456&quot;</code></pre>
</div>
<div id="advanced-example" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Advanced example</h3>
<p>Now we look at a slightly more complicated example. First we give an introduction to some of the general patterns:
- <code>[a-z]</code>: matches every character between a and z (in Unicode code point order)
- <code>[abc]</code>: matches a, b, or c.
- <code>{n}</code>: exactly n matches</p>
<p>If we look at the pattern defined by phone in the code below:
1. <code>([2-9][0-9]{2})</code> means the 1st digit is between 2 and 9, and the 2nd and 3rd digits are both between 0 and 9.
2. <code>[- .]</code> denotes the linkages are symbols, which is one of the 3: “-,” " “(spacing) or.”".
3. <code>([0-9]{3})</code> means the 4th to 6th digits are all between 0 and 9.
4. <code>([0-9]{4})</code> means the last 4 digits are all between 0 and 9.</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="ch-05.html#cb545-1" aria-hidden="true" tabindex="-1"></a>strings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot; 219 733 8965&quot;</span>, <span class="st">&quot;329-293-8753 &quot;</span>,</span>
<span id="cb545-2"><a href="ch-05.html#cb545-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;239 923 8115 and 842 566 4692&quot;</span>,</span>
<span id="cb545-3"><a href="ch-05.html#cb545-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Work: 579-499-7527&quot;</span>,</span>
<span id="cb545-4"><a href="ch-05.html#cb545-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;$1000&quot;</span>,</span>
<span id="cb545-5"><a href="ch-05.html#cb545-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Home: 543.355.3679&quot;</span>)</span>
<span id="cb545-6"><a href="ch-05.html#cb545-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb545-7"><a href="ch-05.html#cb545-7" aria-hidden="true" tabindex="-1"></a>phone <span class="ot">&lt;-</span> <span class="st">&quot;([2-9][0-9]{2})[- .]([0-9]{3})[- .]([0-9]{4})&quot;</span></span>
<span id="cb545-8"><a href="ch-05.html#cb545-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb545-9"><a href="ch-05.html#cb545-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract_all</span>(strings, phone)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;219 733 8965&quot;
## 
## [[2]]
## [1] &quot;329-293-8753&quot;
## 
## [[3]]
## [1] &quot;239 923 8115&quot; &quot;842 566 4692&quot;
## 
## [[4]]
## [1] &quot;579-499-7527&quot;
## 
## [[5]]
## character(0)
## 
## [[6]]
## [1] &quot;543.355.3679&quot;</code></pre>
</div>
</div>
<div id="web-scraping-in-a-nut-shell" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Web-scraping in a nut-shell</h2>
<p>In this session we review some important concepts from web scraping. We will extract the price category of the Coregonus lavaretus. We will do that first using the techniques from week 4 and then using the API <code>rfishbase.</code> The webpage FishBase for the Coregonus lavaretus contains information on its price category which we want to extract.</p>
<p>Let us first load the packages. So the package xml is a tool that is used for Parsing and Generating XML Within R. This package contain many functions e.g. getHTMLLinks, getNodeSet, readHTMLTable etc. Whereas package RCurl is used to get General Network (HTTP/FTP/…) Client Interface for R. It is a wrapper for <a href="http://curl.haxx.se/libcurl/">libcurl</a> and provides functions to compose general HTTP requests and provides convenient functions to fetch URIs, get &amp; post forms, etc. and process the results returned by the Web server.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="ch-05.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(XML)</span>
<span id="cb547-2"><a href="ch-05.html#cb547-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RCurl)</span></code></pre></div>
<p>First, we save our fish species in the object x. Next, we use the function paste() to convert its arguments to character strings and concatenate them to get the link of the webpage from which we are going to extract the data. We concatenate the URL in order to get the webpage with the summary of the species Coregonus-lavaretus. We do not put any separation between the arguments, so we use sep = "".</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="ch-05.html#cb548-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">&quot;Coregonus-lavaretus&quot;</span></span>
<span id="cb548-2"><a href="ch-05.html#cb548-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;http://www.fishbase.de/summary/&quot;</span>,x,<span class="st">&quot;.html&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>We will now use the function getURLContent() to retrieve the source of a webpage, which is especially useful for retrieving pages for data processing. We will apply the function htmlParse() to obtain an R object and extract the div blocks. Now we are ready to get the price category of the Coregonus lavaretus. We will use the function xmlValue() to get the value at the node.</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="ch-05.html#cb549-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">htmlParse</span>(<span class="fu">getURLContent</span>(url, <span class="at">followlocation=</span><span class="cn">TRUE</span>))</span>
<span id="cb549-2"><a href="ch-05.html#cb549-2" aria-hidden="true" tabindex="-1"></a>c_div <span class="ot">&lt;-</span> <span class="fu">getNodeSet</span>(c, <span class="st">&quot;//div &quot;</span>)</span>
<span id="cb549-3"><a href="ch-05.html#cb549-3" aria-hidden="true" tabindex="-1"></a>values_nodes <span class="ot">&lt;-</span> <span class="fu">lapply</span>(c_div,xmlValue)</span>
<span id="cb549-4"><a href="ch-05.html#cb549-4" aria-hidden="true" tabindex="-1"></a>values_nodes</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;&quot;
## 
## [[2]]
## [1] &quot;&quot;
## 
## [[3]]
## [1] &quot;\r\n\t\tYou can sponsor this page\r\n\t\t\t\t\t\t&quot;
## 
## [[4]]
## [1] &quot;You can sponsor this page\r\n\t\t\t\t\t&quot;
## 
## [[5]]
## [1] &quot;\r\n\t\t\r\n\t\t\r\n\t\t\tCommon name (e.g. trout)\r\n\t\t\t\r\n\t\t\t\tcontainsbegins withbegins withends withis\r\n\r\n\t\t\tGenus + Species (e.g. Gadus morhua)\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t \r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t\r\n\t\t \r\n\t\r\n\t\r\n\t\tAbout this page\r\n\t\t\r\n\t\t\t\tMore Info\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tPlus d&#39;info\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tMais info\r\n\t\t\t\r\n\r\n\t\t\r\n\r\n\t\r\n\t\tLanguages\r\n\t\tArabic\r\n\t\t\tBahasa/Malay\r\n\t\t\tBangla\r\n\t\t\tChinese(Si)\r\n\t\t\tChinese(Tr)\r\n\t\t\tDeutsch\r\n\t\t\tEnglish\r\n\t\t\tEspaÃ±ol\r\n\t\t\tFarsi\r\n\t\t\tFranÃ§ais\r\n\t\t\tGreek\r\n\t\t\tHindi\r\n\t\t\tItaliano\r\n\t\t\tJapanese\r\n\t\t\tLao\r\n\t\t\tNederlands\r\n\t\t\tPortuguÃªs(Br)\r\n\t\t\tPortuguÃªs(Pt)\r\n\t\t\tRussian\r\n\t\t\tSwedish\r\n\t\t\tThai\r\n\t\t\tVietnamese\r\n\t\t\r\n\r\n\t\r\n\t\tUser feedbacks\r\n\t\tComments &amp; Corrections\r\n\t\t\tFish Forum\r\n\t\t\tGuest Book\r\n\t\t\tFacebook\r\n\t\t\t\r\n\t\t\r\n\r\n\t\r\n\t\tCitation\r\n\t\r\n\r\n\t\r\n\t\tUploads\r\n\t\tAttach website\r\n\t\t\tUpload photo\r\n\t\t\tUpload video\r\n\t\t\tUpload references\r\n\t\t\tFish Watcher\r\n\t\t\r\n\r\n\t\r\n\t\tRelated species\r\n\t\tSpecies in Coregonus\r\n\t\t\t\tSpecies in Salmonidae\r\n\t\t\t- Classification -Coregoninae\r\n\t\t\t\t\tSalmonidae\r\n\t\t\t\t\tSalmoniformes\r\n\t\t\t\t\tActinopterygii\r\n\t\t\t\t\tChordata\r\n\t\t\t\t\tAnimalia\r\n\t\t\t\t\r\n\t\t  \r\n\t\t\r\n\r\n\r\n\t\t\r\n\t\t\r\n\t\t\t\r\n\t\t\t\tCoregonus lavaretus (Linnaeus,  1758)\t\t\t\r\n\t\t\t\r\n\t\t\t\tEuropean whitefish\t\t\t\r\n\t\t\r\n\r\n\t\t\r\n\r\n\t\t\r\n\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tUpload your photos and videos\r\n\t\t\t\t\r\n\t\t\t\tPictures | \r\n\t\t\t\t\tVideos |\r\n\t\t\t\t\t    Stamps, Coins Misc. | Google imageCoregonus lavaretus\r\n\t\t\t\t\tPicture by\r\n\t\t\t\t\t\r\n\t\t\t\t\tÃ˜stergaard, T.\r\n\r\n$(window).load(function() {\r\n\tif($(\&quot;#ss-photo-full\&quot;).length &gt; 0){\t\t\t//the photo is full width\r\n\t\t$(&#39;#image-slider&#39;).swipeslider({sliderHeight:&#39;27%&#39;, autoPlayTimeout: 8000});\r\n\t}else{\r\n\t\t$(&#39;#image-slider&#39;).swipeslider({sliderHeight:&#39;52%&#39;, autoPlayTimeout: 8000});\r\n\t}\r\n});\r\n\r\n.swipslider{\r\n\tmax-width: 310px;\r\n\tmargin:\tauto;\r\n}\r\n\r\n\r\n\t\t\t \r\n\t\t \r\n\r\n\t\t\r\n\t\t\r\n\t\t\t \r\n\t\t\t\r\n\t\t\t\tClassification / Names  \t\t\t\t \r\n\t\t\t\tCommon names | Synonyms | Catalog of Fishes (gen., sp.) | ITIS | CoL | WoRMS | Cloffa\t\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tActinopterygii (ray-finned fishes) &gt; Salmoniformes (Salmons) &gt; Salmonidae (Salmonids) &gt; Coregoninae\r\n\t\t\t\t\t\t\tEtymology: Coregonus: Greek, kore = pupils of the eye + Greek, gonia = angle (Ref. 45335).  More on author: Linnaeus.\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tEnvironment: milieu / climate zone / depth range / distribution range\t\t\t\t\t\r\n\t\t\t\t\t\tEcology\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tFreshwater; brackish;  demersal; pH range: 7.0 - 7.5; dH range: 20 - ?; anadromous (Ref. 51243).   Temperate; 4°C - 16°C (Ref. 2059); 73°N -   40°N\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tDistribution\t\t\t\t\t\r\n\t\t\t\t\tCountries | FAO areas | Ecosystems | Occurrences | Point map | Introductions | Faunafri\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tEurope:  Native to Lake Bourget (France) and Geneva (Switzerland, France). Population of Lake Aiguebelette (France) apparently introduced, but a &#39;lavaret&#39; had already been recorded from there in the 17th century (Ref. 59043).  Other authors assume it to be a superspecies occurring in Great Britain and Alpine areas of Central Europe.  Has been stocked into many other places in Europe outside its native range.  There are many parallel and wrong scientific names for this species in use because of the problems in classifying the genus Coregonus (Ref. 7495).  Appendix III of the Bern Convention (protected fauna).  Asia:  introduced to Iran (Ref. 39702).\r\n\t\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tLength at first maturity / Size / Weight / Age\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tMaturity: Lm27.1, range 40 - ? cm Max length : 73.0 cm TL male/unsexed; (Ref. 40637); max. published weight: 10.0 kg (Ref. 35388)\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tShort description\t\t\t\t\t\r\n\t\t\t\t\tMorphology | Morphometrics\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\tDorsal\r\n\t\t\t\tspines\r\n\t\t\t\t(total): 3 - 5;\r\n\t\t\t\t\tDorsal\r\n\t\t\t\t\tsoft rays\r\n\t\t\t\t\t(total): 9-12;\r\n\t\t\t\tAnal\r\n\t\t\t\tspines: 3-5;\r\n\t\t\t\t\tAnal\r\n\t\t\t\t\tsoft rays: 10 - 13. Mouth small with protruding upper jaw.  Silvery body (Ref. 35388).  Caudal fin with 19 soft rays (Ref. 40476).\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tBiology\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t   \r\n\t\t\t\tGlossary\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t (e.g.  epibenthic)\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tGregarious lacustrine forms (Ref. 2163) and anadromous estuarine forms, rarely in full saltwater.  Feeds on planktonic crustaceans, or larger benthic crustaceans in brackish water.  Movement in water column as a function of zooplankton repartition (Ref. 2163). Spawns in gravel, near shore, in shallow water, in December (Ref. 59043).  Likely to benefit from environmental regulations in France passed on 8/12/88 (Ref. 2163).\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tLife cycle and mating behavior\t\t\t\t\t\r\n\t\t\t\t\tMaturity | Reproduction | Spawning | Eggs | Fecundity | Larvae\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tSpawning takes place at night.      \t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\r\n\r\n\r\n\t\t\t \r\n\t\t\t\t\r\n\t\t\t\t\tMain reference  \t\t\t\t\t\r\n\t\t\t\t\t\tUpload your references | References | Coordinator | Collaborators\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tWheeler, A., 1992. A list of the common and scientific names of fishes of the British Isles. J. Fish Biol. 41(suppl.A):1-37. (Ref. 5204)\r\n\t\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tIUCN Red List Status   (Ref. 123251)\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t  Vulnerable (VU) (D2); Date assessed: 01 January 2008\t\t\t\t\r\n\t\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tCITES   (Ref. 118484)\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tNot Evaluated\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tCMS (Ref. 116361)\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tNot Evaluated\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t \r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tThreat to humans  \r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t  Harmless\t\t\t\t\r\n\t\t\t\t\r\n\t\t    \r\n\t\t\t\t\r\n\t\t\t\t\tHuman uses  \t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tFisheries: commercial; aquaculture: commercial; gamefish: yes\t\t\t\t\r\n\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tFAO(Aquaculture: production; fisheries: production; publication : search)  | FishSource | Sea Around Us\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tMore information\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tCountriesFAO areasEcosystemsOccurrencesIntroductionsStocksEcologyDietFood itemsFood consumptionRation\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tCommon namesSynonymsMetabolismPredatorsEcotoxicologyReproductionMaturitySpawningSpawning aggregationFecundityEggsEgg development\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tAge/SizeGrowthLength-weightLength-lengthLength-frequenciesMorphometricsMorphologyLarvaeLarval dynamicsRecruitmentAbundance\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tReferencesAquacultureAquaculture profileStrainsGeneticsAllele frequenciesHeritabilityDiseasesProcessingMass conversion\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tCollaboratorsPicturesStamps, Coins Misc.SoundsCiguateraSpeedSwim. typeGill areaOtolithsBrainsVision\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tTools\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tE-book | Field guide | Length-frequency wizard | Life-history tool | Point map | \t\t\t\t\t\tClassification Tree\r\n\t\t\t\t\t\t | Catch-MSY | \t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tSpecial reports\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tCheck for Aquarium maintenance | Check for Species Fact Sheets | Check for Aquaculture Fact Sheets\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tDownload XML\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tSummary page | Point data | Common names | Photos\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tInternet sources\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tAlien/Invasive Species database | Aquatic Commons | BHL | Cloffa | BOLDSystems | Websites from users | Check FishWatcher | CISTI | Catalog of Fishes (gen., sp.) | DiscoverLife | DORIS | ECOTOX | Faunafri | Fishtrace |  GenBank(genome, nucleotide) | GloBI | Google Books | Google Scholar | Google | IGFA World Record | MitoFish | National databases | Otolith Atlas of Taiwan Fishes | PubMed | Reef Life Survey | Tree of Life | Wikipedia(Go, Search) | World Records Freshwater Fishing | Zoological Record\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tEstimates based on models\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tPreferred temperature (Ref. 115969): 5.8 - 12.5, mean 9.5 °C (based on 528 cells).\t\t\t\t\r\n\t\t\t\t \t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tPhylogenetic diversity index  (Ref. 82805):  PD50 = 0.5000   [Uniqueness, from 0.5 = low to 2.0 = high].\t\t\t\t\t\r\n\t\t\t\t\t\r\n                \r\n                    \t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tBayesian length-weight: a=0.00457 (0.00387 - 0.00540), b=3.20 (3.16 - 3.24), in cm total length, based on LWR estimates for this species (Ref. 93245).\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n                    \t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tTrophic level  (Ref. 69278):  3.1   ±0.0 se; based on diet studies.\t\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\r\n\r\n\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t\tResilience  (Ref. 120179):  Medium, minimum population doubling time 1.4 - 4.4 years (K=0.3-0.7; tmax=8; Fecundity=3,800 - 169,800).\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tVulnerability  (Ref. 59153):  Moderate to high vulnerability (51 of 100) .\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tPrice category  (Ref. 80766):  \t\t\t\t\t\tHigh.\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t \r\n\r\n\t\t\r\n\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tEntered by Luna, Susan M.\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tModified by Sampang-Reyes, Arlene G.\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tFish Forum\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tComments &amp; Corrections\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tSign our Guest Book\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tBack to Search\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\tRandom Species\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\tBack to Top\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tAccessed through: Not available\r\n\t\t\t\t\t\t\t\tFishBase mirror site : Kiel, Germany\r\n\t\t\t\t\t\t\tPage last modified by : mrius-barile - 20 July 2016\r\n\t\t\r\n\t\r\n\t\t\r\n\tTotal processing time for the page : 0.7984 seconds\t\t\t\r\n\t\t\r\n\t&quot;
## 
## [[6]]
## [1] &quot;\r\n\t\t\tCommon name (e.g. trout)\r\n\t\t\t\r\n\t\t\t\tcontainsbegins withbegins withends withis\r\n\r\n\t\t\tGenus + Species (e.g. Gadus morhua)\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t&quot;
## 
## [[7]]
## [1] &quot;\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t \r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t\r\n\t\t \r\n\t\r\n\t\r\n\t\tAbout this page\r\n\t\t\r\n\t\t\t\tMore Info\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tPlus d&#39;info\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tMais info\r\n\t\t\t\r\n\r\n\t\t\r\n\r\n\t\r\n\t\tLanguages\r\n\t\tArabic\r\n\t\t\tBahasa/Malay\r\n\t\t\tBangla\r\n\t\t\tChinese(Si)\r\n\t\t\tChinese(Tr)\r\n\t\t\tDeutsch\r\n\t\t\tEnglish\r\n\t\t\tEspaÃ±ol\r\n\t\t\tFarsi\r\n\t\t\tFranÃ§ais\r\n\t\t\tGreek\r\n\t\t\tHindi\r\n\t\t\tItaliano\r\n\t\t\tJapanese\r\n\t\t\tLao\r\n\t\t\tNederlands\r\n\t\t\tPortuguÃªs(Br)\r\n\t\t\tPortuguÃªs(Pt)\r\n\t\t\tRussian\r\n\t\t\tSwedish\r\n\t\t\tThai\r\n\t\t\tVietnamese\r\n\t\t\r\n\r\n\t\r\n\t\tUser feedbacks\r\n\t\tComments &amp; Corrections\r\n\t\t\tFish Forum\r\n\t\t\tGuest Book\r\n\t\t\tFacebook\r\n\t\t\t\r\n\t\t\r\n\r\n\t\r\n\t\tCitation\r\n\t\r\n\r\n\t\r\n\t\tUploads\r\n\t\tAttach website\r\n\t\t\tUpload photo\r\n\t\t\tUpload video\r\n\t\t\tUpload references\r\n\t\t\tFish Watcher\r\n\t\t\r\n\r\n\t\r\n\t\tRelated species\r\n\t\tSpecies in Coregonus\r\n\t\t\t\tSpecies in Salmonidae\r\n\t\t\t- Classification -Coregoninae\r\n\t\t\t\t\tSalmonidae\r\n\t\t\t\t\tSalmoniformes\r\n\t\t\t\t\tActinopterygii\r\n\t\t\t\t\tChordata\r\n\t\t\t\t\tAnimalia\r\n\t\t\t\t\r\n\t\t  \r\n\t\t&quot;
## 
## [[8]]
## [1] &quot;\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t \r\n\t\t\t\r\n\t\t\t&quot;
## 
## [[9]]
## [1] &quot;\r\n\t\t\t\r\n\r\n\t\t\r\n\t\t \r\n\t\r\n\t\r\n\t\tAbout this page\r\n\t\t\r\n\t\t\t\tMore Info\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tPlus d&#39;info\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tMais info\r\n\t\t\t\r\n\r\n\t\t\r\n\r\n\t\r\n\t\tLanguages\r\n\t\tArabic\r\n\t\t\tBahasa/Malay\r\n\t\t\tBangla\r\n\t\t\tChinese(Si)\r\n\t\t\tChinese(Tr)\r\n\t\t\tDeutsch\r\n\t\t\tEnglish\r\n\t\t\tEspaÃ±ol\r\n\t\t\tFarsi\r\n\t\t\tFranÃ§ais\r\n\t\t\tGreek\r\n\t\t\tHindi\r\n\t\t\tItaliano\r\n\t\t\tJapanese\r\n\t\t\tLao\r\n\t\t\tNederlands\r\n\t\t\tPortuguÃªs(Br)\r\n\t\t\tPortuguÃªs(Pt)\r\n\t\t\tRussian\r\n\t\t\tSwedish\r\n\t\t\tThai\r\n\t\t\tVietnamese\r\n\t\t\r\n\r\n\t\r\n\t\tUser feedbacks\r\n\t\tComments &amp; Corrections\r\n\t\t\tFish Forum\r\n\t\t\tGuest Book\r\n\t\t\tFacebook\r\n\t\t\t\r\n\t\t\r\n\r\n\t\r\n\t\tCitation\r\n\t\r\n\r\n\t\r\n\t\tUploads\r\n\t\tAttach website\r\n\t\t\tUpload photo\r\n\t\t\tUpload video\r\n\t\t\tUpload references\r\n\t\t\tFish Watcher\r\n\t\t\r\n\r\n\t\r\n\t\tRelated species\r\n\t\tSpecies in Coregonus\r\n\t\t\t\tSpecies in Salmonidae\r\n\t\t\t- Classification -Coregoninae\r\n\t\t\t\t\tSalmonidae\r\n\t\t\t\t\tSalmoniformes\r\n\t\t\t\t\tActinopterygii\r\n\t\t\t\t\tChordata\r\n\t\t\t\t\tAnimalia\r\n\t\t\t\t\r\n\t\t  &quot;
## 
## [[10]]
## [1] &quot;\r\n\t\t\t\r\n\t\t\t\tCoregonus lavaretus (Linnaeus,  1758)\t\t\t\r\n\t\t\t\r\n\t\t\t\tEuropean whitefish\t\t\t\r\n\t\t&quot;
## 
## [[11]]
## [1] &quot;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tUpload your photos and videos\r\n\t\t\t\t\r\n\t\t\t\tPictures | \r\n\t\t\t\t\tVideos |\r\n\t\t\t\t\t    Stamps, Coins Misc. | Google imageCoregonus lavaretus\r\n\t\t\t\t\tPicture by\r\n\t\t\t\t\t\r\n\t\t\t\t\tÃ˜stergaard, T.\r\n\r\n$(window).load(function() {\r\n\tif($(\&quot;#ss-photo-full\&quot;).length &gt; 0){\t\t\t//the photo is full width\r\n\t\t$(&#39;#image-slider&#39;).swipeslider({sliderHeight:&#39;27%&#39;, autoPlayTimeout: 8000});\r\n\t}else{\r\n\t\t$(&#39;#image-slider&#39;).swipeslider({sliderHeight:&#39;52%&#39;, autoPlayTimeout: 8000});\r\n\t}\r\n});\r\n\r\n.swipslider{\r\n\tmax-width: 310px;\r\n\tmargin:\tauto;\r\n}\r\n\r\n\r\n\t\t\t \r\n\t\t&quot;
## 
## [[12]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tUpload your photos and videos\r\n\t\t\t\t\r\n\t\t\t\tPictures | \r\n\t\t\t\t\tVideos |\r\n\t\t\t\t\t    Stamps, Coins Misc. | Google imageCoregonus lavaretus\r\n\t\t\t\t\tPicture by\r\n\t\t\t\t\t\r\n\t\t\t\t\tÃ˜stergaard, T.\r\n\r\n$(window).load(function() {\r\n\tif($(\&quot;#ss-photo-full\&quot;).length &gt; 0){\t\t\t//the photo is full width\r\n\t\t$(&#39;#image-slider&#39;).swipeslider({sliderHeight:&#39;27%&#39;, autoPlayTimeout: 8000});\r\n\t}else{\r\n\t\t$(&#39;#image-slider&#39;).swipeslider({sliderHeight:&#39;52%&#39;, autoPlayTimeout: 8000});\r\n\t}\r\n});\r\n\r\n.swipslider{\r\n\tmax-width: 310px;\r\n\tmargin:\tauto;\r\n}\r\n\r\n\r\n\t\t\t&quot;
## 
## [[13]]
## [1] &quot;&quot;
## 
## [[14]]
## [1] &quot;\r\n\t\t\t \r\n\t\t\t\r\n\t\t\t\tClassification / Names  \t\t\t\t \r\n\t\t\t\tCommon names | Synonyms | Catalog of Fishes (gen., sp.) | ITIS | CoL | WoRMS | Cloffa\t\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tActinopterygii (ray-finned fishes) &gt; Salmoniformes (Salmons) &gt; Salmonidae (Salmonids) &gt; Coregoninae\r\n\t\t\t\t\t\t\tEtymology: Coregonus: Greek, kore = pupils of the eye + Greek, gonia = angle (Ref. 45335).  More on author: Linnaeus.\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tEnvironment: milieu / climate zone / depth range / distribution range\t\t\t\t\t\r\n\t\t\t\t\t\tEcology\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tFreshwater; brackish;  demersal; pH range: 7.0 - 7.5; dH range: 20 - ?; anadromous (Ref. 51243).   Temperate; 4°C - 16°C (Ref. 2059); 73°N -   40°N\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tDistribution\t\t\t\t\t\r\n\t\t\t\t\tCountries | FAO areas | Ecosystems | Occurrences | Point map | Introductions | Faunafri\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tEurope:  Native to Lake Bourget (France) and Geneva (Switzerland, France). Population of Lake Aiguebelette (France) apparently introduced, but a &#39;lavaret&#39; had already been recorded from there in the 17th century (Ref. 59043).  Other authors assume it to be a superspecies occurring in Great Britain and Alpine areas of Central Europe.  Has been stocked into many other places in Europe outside its native range.  There are many parallel and wrong scientific names for this species in use because of the problems in classifying the genus Coregonus (Ref. 7495).  Appendix III of the Bern Convention (protected fauna).  Asia:  introduced to Iran (Ref. 39702).\r\n\t\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tLength at first maturity / Size / Weight / Age\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tMaturity: Lm27.1, range 40 - ? cm Max length : 73.0 cm TL male/unsexed; (Ref. 40637); max. published weight: 10.0 kg (Ref. 35388)\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tShort description\t\t\t\t\t\r\n\t\t\t\t\tMorphology | Morphometrics\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\tDorsal\r\n\t\t\t\tspines\r\n\t\t\t\t(total): 3 - 5;\r\n\t\t\t\t\tDorsal\r\n\t\t\t\t\tsoft rays\r\n\t\t\t\t\t(total): 9-12;\r\n\t\t\t\tAnal\r\n\t\t\t\tspines: 3-5;\r\n\t\t\t\t\tAnal\r\n\t\t\t\t\tsoft rays: 10 - 13. Mouth small with protruding upper jaw.  Silvery body (Ref. 35388).  Caudal fin with 19 soft rays (Ref. 40476).\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tBiology\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t   \r\n\t\t\t\tGlossary\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t (e.g.  epibenthic)\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tGregarious lacustrine forms (Ref. 2163) and anadromous estuarine forms, rarely in full saltwater.  Feeds on planktonic crustaceans, or larger benthic crustaceans in brackish water.  Movement in water column as a function of zooplankton repartition (Ref. 2163). Spawns in gravel, near shore, in shallow water, in December (Ref. 59043).  Likely to benefit from environmental regulations in France passed on 8/12/88 (Ref. 2163).\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tLife cycle and mating behavior\t\t\t\t\t\r\n\t\t\t\t\tMaturity | Reproduction | Spawning | Eggs | Fecundity | Larvae\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tSpawning takes place at night.      \t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\r\n\r\n\r\n\t\t\t \r\n\t\t\t\t\r\n\t\t\t\t\tMain reference  \t\t\t\t\t\r\n\t\t\t\t\t\tUpload your references | References | Coordinator | Collaborators\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tWheeler, A., 1992. A list of the common and scientific names of fishes of the British Isles. J. Fish Biol. 41(suppl.A):1-37. (Ref. 5204)\r\n\t\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tIUCN Red List Status   (Ref. 123251)\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t  Vulnerable (VU) (D2); Date assessed: 01 January 2008\t\t\t\t\r\n\t\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tCITES   (Ref. 118484)\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tNot Evaluated\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tCMS (Ref. 116361)\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tNot Evaluated\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t \r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tThreat to humans  \r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t  Harmless\t\t\t\t\r\n\t\t\t\t\r\n\t\t    \r\n\t\t\t\t\r\n\t\t\t\t\tHuman uses  \t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tFisheries: commercial; aquaculture: commercial; gamefish: yes\t\t\t\t\r\n\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tFAO(Aquaculture: production; fisheries: production; publication : search)  | FishSource | Sea Around Us\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tMore information\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tCountriesFAO areasEcosystemsOccurrencesIntroductionsStocksEcologyDietFood itemsFood consumptionRation\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tCommon namesSynonymsMetabolismPredatorsEcotoxicologyReproductionMaturitySpawningSpawning aggregationFecundityEggsEgg development\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tAge/SizeGrowthLength-weightLength-lengthLength-frequenciesMorphometricsMorphologyLarvaeLarval dynamicsRecruitmentAbundance\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tReferencesAquacultureAquaculture profileStrainsGeneticsAllele frequenciesHeritabilityDiseasesProcessingMass conversion\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tCollaboratorsPicturesStamps, Coins Misc.SoundsCiguateraSpeedSwim. typeGill areaOtolithsBrainsVision\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tTools\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tE-book | Field guide | Length-frequency wizard | Life-history tool | Point map | \t\t\t\t\t\tClassification Tree\r\n\t\t\t\t\t\t | Catch-MSY | \t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tSpecial reports\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tCheck for Aquarium maintenance | Check for Species Fact Sheets | Check for Aquaculture Fact Sheets\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tDownload XML\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tSummary page | Point data | Common names | Photos\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tInternet sources\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tAlien/Invasive Species database | Aquatic Commons | BHL | Cloffa | BOLDSystems | Websites from users | Check FishWatcher | CISTI | Catalog of Fishes (gen., sp.) | DiscoverLife | DORIS | ECOTOX | Faunafri | Fishtrace |  GenBank(genome, nucleotide) | GloBI | Google Books | Google Scholar | Google | IGFA World Record | MitoFish | National databases | Otolith Atlas of Taiwan Fishes | PubMed | Reef Life Survey | Tree of Life | Wikipedia(Go, Search) | World Records Freshwater Fishing | Zoological Record\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tEstimates based on models\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tPreferred temperature (Ref. 115969): 5.8 - 12.5, mean 9.5 °C (based on 528 cells).\t\t\t\t\r\n\t\t\t\t \t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tPhylogenetic diversity index  (Ref. 82805):  PD50 = 0.5000   [Uniqueness, from 0.5 = low to 2.0 = high].\t\t\t\t\t\r\n\t\t\t\t\t\r\n                \r\n                    \t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tBayesian length-weight: a=0.00457 (0.00387 - 0.00540), b=3.20 (3.16 - 3.24), in cm total length, based on LWR estimates for this species (Ref. 93245).\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n                    \t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tTrophic level  (Ref. 69278):  3.1   ±0.0 se; based on diet studies.\t\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\r\n\r\n\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t\tResilience  (Ref. 120179):  Medium, minimum population doubling time 1.4 - 4.4 years (K=0.3-0.7; tmax=8; Fecundity=3,800 - 169,800).\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tVulnerability  (Ref. 59153):  Moderate to high vulnerability (51 of 100) .\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tPrice category  (Ref. 80766):  \t\t\t\t\t\tHigh.\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t&quot;
## 
## [[15]]
## [1] &quot;\r\n\t\t\t\tActinopterygii (ray-finned fishes) &gt; Salmoniformes (Salmons) &gt; Salmonidae (Salmonids) &gt; Coregoninae\r\n\t\t\t\t\t\t\tEtymology: Coregonus: Greek, kore = pupils of the eye + Greek, gonia = angle (Ref. 45335).  More on author: Linnaeus.\t\t\t\t\t\t\r\n\t\t\t\t\t&quot;
## 
## [[16]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tFreshwater; brackish;  demersal; pH range: 7.0 - 7.5; dH range: 20 - ?; anadromous (Ref. 51243).   Temperate; 4°C - 16°C (Ref. 2059); 73°N -   40°N\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[17]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tEurope:  Native to Lake Bourget (France) and Geneva (Switzerland, France). Population of Lake Aiguebelette (France) apparently introduced, but a &#39;lavaret&#39; had already been recorded from there in the 17th century (Ref. 59043).  Other authors assume it to be a superspecies occurring in Great Britain and Alpine areas of Central Europe.  Has been stocked into many other places in Europe outside its native range.  There are many parallel and wrong scientific names for this species in use because of the problems in classifying the genus Coregonus (Ref. 7495).  Appendix III of the Bern Convention (protected fauna).  Asia:  introduced to Iran (Ref. 39702).\r\n\t\t\t\t&quot;
## 
## [[18]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tMaturity: Lm27.1, range 40 - ? cm Max length : 73.0 cm TL male/unsexed; (Ref. 40637); max. published weight: 10.0 kg (Ref. 35388)\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[19]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\tDorsal\r\n\t\t\t\tspines\r\n\t\t\t\t(total): 3 - 5;\r\n\t\t\t\t\tDorsal\r\n\t\t\t\t\tsoft rays\r\n\t\t\t\t\t(total): 9-12;\r\n\t\t\t\tAnal\r\n\t\t\t\tspines: 3-5;\r\n\t\t\t\t\tAnal\r\n\t\t\t\t\tsoft rays: 10 - 13. Mouth small with protruding upper jaw.  Silvery body (Ref. 35388).  Caudal fin with 19 soft rays (Ref. 40476).\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[20]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tBiology\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t   \r\n\t\t\t\tGlossary\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t (e.g.  epibenthic)\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t&quot;
## 
## [[21]]
## [1] &quot;\r\n\t\t\t\r\n\t\t\t\tGregarious lacustrine forms (Ref. 2163) and anadromous estuarine forms, rarely in full saltwater.  Feeds on planktonic crustaceans, or larger benthic crustaceans in brackish water.  Movement in water column as a function of zooplankton repartition (Ref. 2163). Spawns in gravel, near shore, in shallow water, in December (Ref. 59043).  Likely to benefit from environmental regulations in France passed on 8/12/88 (Ref. 2163).\t\t\t\r\n\t\t\t&quot;
## 
## [[22]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\tSpawning takes place at night.      \t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[23]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tWheeler, A., 1992. A list of the common and scientific names of fishes of the British Isles. J. Fish Biol. 41(suppl.A):1-37. (Ref. 5204)\r\n\t\t\t\t&quot;
## 
## [[24]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tIUCN Red List Status   (Ref. 123251)\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t  Vulnerable (VU) (D2); Date assessed: 01 January 2008\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[25]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\t  Vulnerable (VU) (D2); Date assessed: 01 January 2008\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[26]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tCITES   (Ref. 118484)\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tNot Evaluated\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[27]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tNot Evaluated\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[28]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tCMS (Ref. 116361)\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tNot Evaluated\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[29]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tNot Evaluated\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[30]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tThreat to humans  \r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t  Harmless\t\t\t\t\r\n\t\t\t\t\r\n\t\t    &quot;
## 
## [[31]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\t  Harmless\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[32]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tFisheries: commercial; aquaculture: commercial; gamefish: yes\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[33]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tFAO(Aquaculture: production; fisheries: production; publication : search)  | FishSource | Sea Around Us\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[34]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tMore information\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tCountriesFAO areasEcosystemsOccurrencesIntroductionsStocksEcologyDietFood itemsFood consumptionRation\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tCommon namesSynonymsMetabolismPredatorsEcotoxicologyReproductionMaturitySpawningSpawning aggregationFecundityEggsEgg development\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tAge/SizeGrowthLength-weightLength-lengthLength-frequenciesMorphometricsMorphologyLarvaeLarval dynamicsRecruitmentAbundance\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tReferencesAquacultureAquaculture profileStrainsGeneticsAllele frequenciesHeritabilityDiseasesProcessingMass conversion\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tCollaboratorsPicturesStamps, Coins Misc.SoundsCiguateraSpeedSwim. typeGill areaOtolithsBrainsVision\r\n\t\t\t\t\r\n\t\t\t&quot;
## 
## [[35]]
## [1] &quot;\r\n\t\t\t\t\t\tCountriesFAO areasEcosystemsOccurrencesIntroductionsStocksEcologyDietFood itemsFood consumptionRation&quot;
## 
## [[36]]
## [1] &quot;\r\n\t\t\t\t\t\tCommon namesSynonymsMetabolismPredatorsEcotoxicologyReproductionMaturitySpawningSpawning aggregationFecundityEggsEgg development&quot;
## 
## [[37]]
## [1] &quot;\r\n\t\t\t\t\t\tAge/SizeGrowthLength-weightLength-lengthLength-frequenciesMorphometricsMorphologyLarvaeLarval dynamicsRecruitmentAbundance&quot;
## 
## [[38]]
## [1] &quot;\r\n\t\t\t\t\t\tReferencesAquacultureAquaculture profileStrainsGeneticsAllele frequenciesHeritabilityDiseasesProcessingMass conversion&quot;
## 
## [[39]]
## [1] &quot;\r\n\t\t\t\t\t\tCollaboratorsPicturesStamps, Coins Misc.SoundsCiguateraSpeedSwim. typeGill areaOtolithsBrainsVision&quot;
## 
## [[40]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tE-book | Field guide | Length-frequency wizard | Life-history tool | Point map | \t\t\t\t\t\tClassification Tree\r\n\t\t\t\t\t\t | Catch-MSY | \t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[41]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tCheck for Aquarium maintenance | Check for Species Fact Sheets | Check for Aquaculture Fact Sheets\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[42]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tSummary page | Point data | Common names | Photos\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[43]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\t\tAlien/Invasive Species database | Aquatic Commons | BHL | Cloffa | BOLDSystems | Websites from users | Check FishWatcher | CISTI | Catalog of Fishes (gen., sp.) | DiscoverLife | DORIS | ECOTOX | Faunafri | Fishtrace |  GenBank(genome, nucleotide) | GloBI | Google Books | Google Scholar | Google | IGFA World Record | MitoFish | National databases | Otolith Atlas of Taiwan Fishes | PubMed | Reef Life Survey | Tree of Life | Wikipedia(Go, Search) | World Records Freshwater Fishing | Zoological Record\t\t\t\t\r\n\t\t\t\t&quot;
## 
## [[44]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\tPreferred temperature (Ref. 115969): 5.8 - 12.5, mean 9.5 °C (based on 528 cells).\t\t\t\t\r\n\t\t\t\t \t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tPhylogenetic diversity index  (Ref. 82805):  PD50 = 0.5000   [Uniqueness, from 0.5 = low to 2.0 = high].\t\t\t\t\t\r\n\t\t\t\t\t\r\n                \r\n                    \t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tBayesian length-weight: a=0.00457 (0.00387 - 0.00540), b=3.20 (3.16 - 3.24), in cm total length, based on LWR estimates for this species (Ref. 93245).\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n                    \t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tTrophic level  (Ref. 69278):  3.1   ±0.0 se; based on diet studies.\t\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\r\n\r\n\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t\tResilience  (Ref. 120179):  Medium, minimum population doubling time 1.4 - 4.4 years (K=0.3-0.7; tmax=8; Fecundity=3,800 - 169,800).\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tVulnerability  (Ref. 59153):  Moderate to high vulnerability (51 of 100) .\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tPrice category  (Ref. 80766):  \t\t\t\t\t\tHigh.\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t&quot;
## 
## [[45]]
## [1] &quot;\r\n\t\t\t\t\tPhylogenetic diversity index  (Ref. 82805):  PD50 = 0.5000   [Uniqueness, from 0.5 = low to 2.0 = high].\t\t\t\t\t&quot;
## 
## [[46]]
## [1] &quot;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tBayesian length-weight: a=0.00457 (0.00387 - 0.00540), b=3.20 (3.16 - 3.24), in cm total length, based on LWR estimates for this species (Ref. 93245).\t\t\t\t\t\t\r\n\t\t\t\t\t&quot;
## 
## [[47]]
## [1] &quot;\r\n\t\t\t\t\tTrophic level  (Ref. 69278):  3.1   ±0.0 se; based on diet studies.\t\t\t\t\t&quot;
## 
## [[48]]
## [1] &quot;\r\n\t\t\t\t\t\t\t\t\t\t\t&quot;
## 
## [[49]]
## [1] &quot;\r\n\t\t\t\t\tResilience  (Ref. 120179):  Medium, minimum population doubling time 1.4 - 4.4 years (K=0.3-0.7; tmax=8; Fecundity=3,800 - 169,800).\t\t\t\t\t&quot;
## 
## [[50]]
## [1] &quot;\r\n\t\t\t\t\t\t\t\t\t\t\t&quot;
## 
## [[51]]
## [1] &quot;\r\n\t\t\t\t\tVulnerability  (Ref. 59153):  Moderate to high vulnerability (51 of 100) .\t\t\t\t\t&quot;
## 
## [[52]]
## [1] &quot;\r\n\t\t\t\t\t\t\t\t\t\t\tPrice category  (Ref. 80766):  \t\t\t\t\t\tHigh.\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t&quot;
## 
## [[53]]
## [1] &quot;\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tEntered by Luna, Susan M.\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tModified by Sampang-Reyes, Arlene G.\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tFish Forum\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tComments &amp; Corrections\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tSign our Guest Book\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tBack to Search\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\tRandom Species\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\tBack to Top\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tAccessed through: Not available\r\n\t\t\t\t\t\t\t\tFishBase mirror site : Kiel, Germany\r\n\t\t\t\t\t\t\tPage last modified by : mrius-barile - 20 July 2016\r\n\t\t\r\n\t\r\n\t\t\r\n\tTotal processing time for the page : 0.7984 seconds\t\t\t\r\n\t\t&quot;
## 
## [[54]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\tEntered by Luna, Susan M.\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tModified by Sampang-Reyes, Arlene G.\t\t\t\t\r\n\t\t\t&quot;
## 
## [[55]]
## [1] &quot;\r\n\t\t\t\tEntered by Luna, Susan M.\t\t\t\t&quot;
## 
## [[56]]
## [1] &quot;\r\n\t\t\t\tModified by Sampang-Reyes, Arlene G.\t\t\t\t&quot;
## 
## [[57]]
## [1] &quot;\r\n\t\t\t\tFish Forum\t\t\t&quot;
## 
## [[58]]
## [1] &quot;\r\n\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tComments &amp; Corrections\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t&quot;
## 
## [[59]]
## [1] &quot;\r\n\t\t\t\tSign our Guest Book\t\t\t&quot;
## 
## [[60]]
## [1] &quot;\r\n\t\t\t\t\r\n\t\t\t\tBack to Search\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\tRandom Species\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\tBack to Top\t\t\t\t\r\n\t\t\t&quot;
## 
## [[61]]
## [1] &quot;\r\n\t\t\t\tBack to Search\t\t\t\t&quot;
## 
## [[62]]
## [1] &quot;\r\n\t\t\t\tRandom Species\t\t\t\t&quot;
## 
## [[63]]
## [1] &quot;\r\n\t\t\t\tBack to Top\t\t\t\t&quot;
## 
## [[64]]
## [1] &quot;\r\n\t\t\t\tAccessed through: Not available\r\n\t\t\t\t\t\t\t\tFishBase mirror site : Kiel, Germany\r\n\t\t\t\t\t\t\tPage last modified by : mrius-barile - 20 July 2016\r\n\t\t\r\n\t\r\n\t\t\r\n\tTotal processing time for the page : 0.7984 seconds\t\t\t&quot;
## 
## [[65]]
## [1] &quot;\r\n\t\t\t\t\t\t\t\tFishBase mirror site : Kiel, Germany\r\n\t\t\t\t\t\t\t&quot;</code></pre>
<p>Next we look for the pattern “Price category” in the variable values_nodes. Then we look at which position we can find our information.</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="ch-05.html#cb551-1" aria-hidden="true" tabindex="-1"></a>values_pattern <span class="ot">&lt;-</span> <span class="fu">sapply</span>(values_nodes, <span class="cf">function</span>(x){<span class="fu">regexec</span>(<span class="at">pattern=</span><span class="st">&quot;Price category&quot;</span>, x)[[<span class="dv">1</span>]][<span class="dv">1</span>]})</span>
<span id="cb551-2"><a href="ch-05.html#cb551-2" aria-hidden="true" tabindex="-1"></a>values_pattern</span></code></pre></div>
<pre><code>##  [1]   -1   -1   -1   -1 8470   -1   -1   -1   -1   -1   -1   -1   -1 6720   -1
## [16]   -1   -1   -1   -1   -1   -1   -1   -1   -1   -1   -1   -1   -1   -1   -1
## [31]   -1   -1   -1   -1   -1   -1   -1   -1   -1   -1   -1   -1   -1  950   -1
## [46]   -1   -1   -1   -1   -1   -1   14   -1   -1   -1   -1   -1   -1   -1   -1
## [61]   -1   -1   -1   -1   -1</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="ch-05.html#cb553-1" aria-hidden="true" tabindex="-1"></a>w_Price <span class="ot">&lt;-</span> <span class="fu">which</span>(values_pattern <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb553-2"><a href="ch-05.html#cb553-2" aria-hidden="true" tabindex="-1"></a>w_Price</span></code></pre></div>
<pre><code>## [1]  5 14 44 52</code></pre>
<p>Now we can look at the informations contained at the found positions. If w_Price is empty, then we set the price category as NA. Otherwise we get the value at the foud positions using the function xmlValue().</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="ch-05.html#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(w_Price)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb555-2"><a href="ch-05.html#cb555-2" aria-hidden="true" tabindex="-1"></a>  Price<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb555-3"><a href="ch-05.html#cb555-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb555-4"><a href="ch-05.html#cb555-4" aria-hidden="true" tabindex="-1"></a>  d1_Price <span class="ot">&lt;-</span> <span class="fu">xmlValue</span>(c_div[[w_Price[<span class="fu">length</span>(w_Price)]]])</span>
<span id="cb555-5"><a href="ch-05.html#cb555-5" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb555-6"><a href="ch-05.html#cb555-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-7"><a href="ch-05.html#cb555-7" aria-hidden="true" tabindex="-1"></a>d1_Price</span></code></pre></div>
<pre><code>## [1] &quot;\r\n\t\t\t\t\t\t\t\t\t\t\tPrice category  (Ref. 80766):  \t\t\t\t\t\tHigh.\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t&quot;</code></pre>
<p>Next we can extract the relevant information from d1_price. We can use the function strsplit() to obtain the part of the string after “:” We need to take the second element in the first position in the list. We now use the function regmatches to extract matched substrings from match data obtained by gregexpr. We get a list with one element, so we can extract this element from the list. Now we use the function gregexpr() to search for alphabetic characters. We then use the function regmatches to extract matched substrings from match data obtained by gregexpr which gives a list with one element, so we can extract this element from the list.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="ch-05.html#cb557-1" aria-hidden="true" tabindex="-1"></a>(int <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(d1_Price,<span class="st">&quot;:&quot;</span>))</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;\r\n\t\t\t\t\t\t\t\t\t\t\tPrice category  (Ref. 80766)&quot;                   
## [2] &quot;  \t\t\t\t\t\tHigh.\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t&quot;</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="ch-05.html#cb559-1" aria-hidden="true" tabindex="-1"></a>(int <span class="ot">&lt;-</span> int[[<span class="dv">1</span>]][<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] &quot;  \t\t\t\t\t\tHigh.\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t&quot;</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="ch-05.html#cb561-1" aria-hidden="true" tabindex="-1"></a>alph_char <span class="ot">&lt;-</span> <span class="fu">gregexpr</span>(<span class="at">pattern=</span> <span class="st">&quot;[[:alpha:]]+&quot;</span>,int) <span class="co"># find starting position and length of all matches</span></span>
<span id="cb561-2"><a href="ch-05.html#cb561-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-3"><a href="ch-05.html#cb561-3" aria-hidden="true" tabindex="-1"></a>(Price <span class="ot">&lt;-</span> <span class="fu">regmatches</span>(int, alph_char))</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;High&quot;</code></pre>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="ch-05.html#cb563-1" aria-hidden="true" tabindex="-1"></a>(Price <span class="ot">&lt;-</span> Price[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## [1] &quot;High&quot;</code></pre>
<p>Or alternatively to this entire web scraping part, we can directly use the rfishbase package:</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="ch-05.html#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rfishbase)</span>
<span id="cb565-2"><a href="ch-05.html#cb565-2" aria-hidden="true" tabindex="-1"></a><span class="fu">species</span>(<span class="st">&quot;Coregonus lavaretus&quot;</span>, <span class="st">&quot;PriceCateg&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   PriceCateg
##   &lt;chr&gt;     
## 1 high</code></pre>
<p>Using both the methods we can get the price category of the Coregonus lavaretus and it gives the same results. Using an API to fetch data from the web is very handy as we can see in the example above whereas web scraping is bit tideous.</p>
</div>
<div id="tidyverses-filter-and-select" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Tidyverse’s filter and select</h2>
<div id="introduction-4" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Introduction</h3>
<p>Writing code is learning a language!
- Learn the grammar of a function (i.e. sentence)
- Learn how to connect functions
- Learn how to express your thoughts
- Learn how to get translations from the web (Google is your best friend!)</p>
<p>Let’s load tidyverse package and have a look at the star wars data:</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="ch-05.html#cb567-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb567-2"><a href="ch-05.html#cb567-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-3"><a href="ch-05.html#cb567-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> starwars</span>
<span id="cb567-4"><a href="ch-05.html#cb567-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-5"><a href="ch-05.html#cb567-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(dat)         <span class="co"># Number of Columns</span></span></code></pre></div>
<pre><code>## [1] 14</code></pre>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="ch-05.html#cb569-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dat)         <span class="co"># Number of Rows</span></span></code></pre></div>
<pre><code>## [1] 87</code></pre>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="ch-05.html#cb571-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dat)          <span class="co"># Dimension (Rows x Columns)</span></span></code></pre></div>
<pre><code>## [1] 87 14</code></pre>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="ch-05.html#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dat)     <span class="co"># Look at variables in dat       in tidyverse: dat %&gt;% names(.)</span></span></code></pre></div>
<pre><code>##  [1] &quot;name&quot;       &quot;height&quot;     &quot;mass&quot;       &quot;hair_color&quot; &quot;skin_color&quot;
##  [6] &quot;eye_color&quot;  &quot;birth_year&quot; &quot;sex&quot;        &quot;gender&quot;     &quot;homeworld&quot; 
## [11] &quot;species&quot;    &quot;films&quot;      &quot;vehicles&quot;   &quot;starships&quot;</code></pre>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="ch-05.html#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)         <span class="co"># Look at top 6 entries of dat   in tidyverse: dat %&gt;% head()</span></span></code></pre></div>
<pre><code>## # A tibble: 6 x 14
##   name     height  mass hair_color  skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Luke Sk…    172    77 blond       fair       blue            19   male  mascu…
## 2 C-3PO       167    75 &lt;NA&gt;        gold       yellow         112   none  mascu…
## 3 R2-D2        96    32 &lt;NA&gt;        white, bl… red             33   none  mascu…
## 4 Darth V…    202   136 none        white      yellow          41.9 male  mascu…
## 5 Leia Or…    150    49 brown       light      brown           19   fema… femin…
## 6 Owen La…    178   120 brown, grey light      blue            52   male  mascu…
## # … with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="ch-05.html#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(dat, <span class="dv">10</span>)     <span class="co"># Look at last 10 entries of dat in tidyverse: dat %&gt;% tail()</span></span></code></pre></div>
<pre><code>## # A tibble: 10 x 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Tarfful     234   136 brown      brown      blue              NA male  mascu…
##  2 Raymus …    188    79 brown      light      brown             NA male  mascu…
##  3 Sly Moo…    178    48 none       pale       white             NA &lt;NA&gt;  &lt;NA&gt;  
##  4 Tion Me…    206    80 none       grey       black             NA male  mascu…
##  5 Finn         NA    NA black      dark       dark              NA male  mascu…
##  6 Rey          NA    NA brown      light      hazel             NA fema… femin…
##  7 Poe Dam…     NA    NA brown      light      brown             NA male  mascu…
##  8 BB8          NA    NA none       none       black             NA none  mascu…
##  9 Captain…     NA    NA unknown    unknown    unknown           NA &lt;NA&gt;  &lt;NA&gt;  
## 10 Padmé A…    165    45 brown      light      brown             46 fema… femin…
## # … with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="ch-05.html#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">names</span>(dat))  <span class="co"># Look at last 6 columns of dat  in tidyverse: dat %&gt;% tail(names(.))</span></span></code></pre></div>
<pre><code>## [1] &quot;gender&quot;    &quot;homeworld&quot; &quot;species&quot;   &quot;films&quot;     &quot;vehicles&quot;  &quot;starships&quot;</code></pre>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="ch-05.html#cb581-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>films[<span class="dv">1</span>]      <span class="co"># Accessing the entire list of the first entry</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;The Empire Strikes Back&quot; &quot;Revenge of the Sith&quot;    
## [3] &quot;Return of the Jedi&quot;      &quot;A New Hope&quot;             
## [5] &quot;The Force Awakens&quot;</code></pre>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="ch-05.html#cb583-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>films[[<span class="dv">1</span>]]    <span class="co"># Accessing the entire list of the first entry</span></span></code></pre></div>
<pre><code>## [1] &quot;The Empire Strikes Back&quot; &quot;Revenge of the Sith&quot;    
## [3] &quot;Return of the Jedi&quot;      &quot;A New Hope&quot;             
## [5] &quot;The Force Awakens&quot;</code></pre>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="ch-05.html#cb585-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>films[[<span class="dv">1</span>]][<span class="dv">3</span>] <span class="co"># Accessing the third object in the list of the first entry</span></span></code></pre></div>
<pre><code>## [1] &quot;Return of the Jedi&quot;</code></pre>
</div>
<div id="select" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Select()</h3>
<p><code>select()</code> is a straightforward to pick your varialbes (features) of interes. It can be used in various ways, even by adding functions and operators to its arguments.</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="ch-05.html#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="co"># When doing selections and filters: Always save your data frame using &quot;&lt;-&quot;</span></span>
<span id="cb587-2"><a href="ch-05.html#cb587-2" aria-hidden="true" tabindex="-1"></a>new_df <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb587-3"><a href="ch-05.html#cb587-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-4"><a href="ch-05.html#cb587-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Specific</span></span>
<span id="cb587-5"><a href="ch-05.html#cb587-5" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">2</span>)                     <span class="co"># select by column number</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 2
##    name               height
##    &lt;chr&gt;               &lt;int&gt;
##  1 Luke Skywalker        172
##  2 C-3PO                 167
##  3 R2-D2                  96
##  4 Darth Vader           202
##  5 Leia Organa           150
##  6 Owen Lars             178
##  7 Beru Whitesun lars    165
##  8 R5-D4                  97
##  9 Biggs Darklighter     183
## 10 Obi-Wan Kenobi        182
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="ch-05.html#cb589-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">2</span>,<span class="dv">1</span>)                     <span class="co"># rearrange columns</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 2
##    height name              
##     &lt;int&gt; &lt;chr&gt;             
##  1    172 Luke Skywalker    
##  2    167 C-3PO             
##  3     96 R2-D2             
##  4    202 Darth Vader       
##  5    150 Leia Organa       
##  6    178 Owen Lars         
##  7    165 Beru Whitesun lars
##  8     97 R5-D4             
##  9    183 Biggs Darklighter 
## 10    182 Obi-Wan Kenobi    
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="ch-05.html#cb591-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(name, height, starships) <span class="co"># select by names</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 3
##    name               height starships
##    &lt;chr&gt;               &lt;int&gt; &lt;list&gt;   
##  1 Luke Skywalker        172 &lt;chr [2]&gt;
##  2 C-3PO                 167 &lt;chr [0]&gt;
##  3 R2-D2                  96 &lt;chr [0]&gt;
##  4 Darth Vader           202 &lt;chr [1]&gt;
##  5 Leia Organa           150 &lt;chr [0]&gt;
##  6 Owen Lars             178 &lt;chr [0]&gt;
##  7 Beru Whitesun lars    165 &lt;chr [0]&gt;
##  8 R5-D4                  97 &lt;chr [0]&gt;
##  9 Biggs Darklighter     183 &lt;chr [1]&gt;
## 10 Obi-Wan Kenobi        182 &lt;chr [5]&gt;
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="ch-05.html#cb593-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">H =</span> height, <span class="at">N =</span> name)    <span class="co"># renaming Variables</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 2
##        H N                 
##    &lt;int&gt; &lt;chr&gt;             
##  1   172 Luke Skywalker    
##  2   167 C-3PO             
##  3    96 R2-D2             
##  4   202 Darth Vader       
##  5   150 Leia Organa       
##  6   178 Owen Lars         
##  7   165 Beru Whitesun lars
##  8    97 R5-D4             
##  9   183 Biggs Darklighter 
## 10   182 Obi-Wan Kenobi    
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="ch-05.html#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Backwards</span></span>
<span id="cb595-2"><a href="ch-05.html#cb595-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">tail</span>(<span class="fu">names</span>(dat), <span class="dv">2</span>))     <span class="co"># select the last two variables</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 2
##    vehicles  starships
##    &lt;list&gt;    &lt;list&gt;   
##  1 &lt;chr [2]&gt; &lt;chr [2]&gt;
##  2 &lt;chr [0]&gt; &lt;chr [0]&gt;
##  3 &lt;chr [0]&gt; &lt;chr [0]&gt;
##  4 &lt;chr [0]&gt; &lt;chr [1]&gt;
##  5 &lt;chr [1]&gt; &lt;chr [0]&gt;
##  6 &lt;chr [0]&gt; &lt;chr [0]&gt;
##  7 &lt;chr [0]&gt; &lt;chr [0]&gt;
##  8 &lt;chr [0]&gt; &lt;chr [0]&gt;
##  9 &lt;chr [0]&gt; &lt;chr [1]&gt;
## 10 &lt;chr [1]&gt; &lt;chr [5]&gt;
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="ch-05.html#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deletion</span></span>
<span id="cb597-2"><a href="ch-05.html#cb597-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>name)                   <span class="co"># using a minus sign for deleting column name</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 13
##    height  mass hair_color    skin_color  eye_color birth_year sex    gender   
##     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
##  1    172    77 blond         fair        blue            19   male   masculine
##  2    167    75 &lt;NA&gt;          gold        yellow         112   none   masculine
##  3     96    32 &lt;NA&gt;          white, blue red             33   none   masculine
##  4    202   136 none          white       yellow          41.9 male   masculine
##  5    150    49 brown         light       brown           19   female feminine 
##  6    178   120 brown, grey   light       blue            52   male   masculine
##  7    165    75 brown         light       blue            47   female feminine 
##  8     97    32 &lt;NA&gt;          white, red  red             NA   none   masculine
##  9    183    84 black         light       brown           24   male   masculine
## 10    182    77 auburn, white fair        blue-gray       57   male   masculine
## # … with 77 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,
## #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="ch-05.html#cb599-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))                  <span class="co"># same as select((5:length(dat)))</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 10
##    skin_color eye_color birth_year sex   gender homeworld species films vehicles
##    &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;lis&gt; &lt;list&gt;  
##  1 fair       blue            19   male  mascu… Tatooine  Human   &lt;chr… &lt;chr [2…
##  2 gold       yellow         112   none  mascu… Tatooine  Droid   &lt;chr… &lt;chr [0…
##  3 white, bl… red             33   none  mascu… Naboo     Droid   &lt;chr… &lt;chr [0…
##  4 white      yellow          41.9 male  mascu… Tatooine  Human   &lt;chr… &lt;chr [0…
##  5 light      brown           19   fema… femin… Alderaan  Human   &lt;chr… &lt;chr [1…
##  6 light      blue            52   male  mascu… Tatooine  Human   &lt;chr… &lt;chr [0…
##  7 light      blue            47   fema… femin… Tatooine  Human   &lt;chr… &lt;chr [0…
##  8 white, red red             NA   none  mascu… Tatooine  Droid   &lt;chr… &lt;chr [0…
##  9 light      brown           24   male  mascu… Tatooine  Human   &lt;chr… &lt;chr [0…
## 10 fair       blue-gray       57   male  mascu… Stewjon   Human   &lt;chr… &lt;chr [1…
## # … with 77 more rows, and 1 more variable: starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="ch-05.html#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Range</span></span>
<span id="cb601-2"><a href="ch-05.html#cb601-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)                     <span class="co"># 1:4 is a vector from 1 to 4</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 4
##    name               height  mass hair_color   
##    &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;        
##  1 Luke Skywalker        172    77 blond        
##  2 C-3PO                 167    75 &lt;NA&gt;         
##  3 R2-D2                  96    32 &lt;NA&gt;         
##  4 Darth Vader           202   136 none         
##  5 Leia Organa           150    49 brown        
##  6 Owen Lars             178   120 brown, grey  
##  7 Beru Whitesun lars    165    75 brown        
##  8 R5-D4                  97    32 &lt;NA&gt;         
##  9 Biggs Darklighter     183    84 black        
## 10 Obi-Wan Kenobi        182    77 auburn, white
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="ch-05.html#cb603-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(dat), <span class="dv">2</span>))  <span class="co"># seq() creates a sequence; selects every 2nd column</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 7
##    name                mass skin_color  birth_year gender    species vehicles 
##    &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;list&gt;   
##  1 Luke Skywalker        77 fair              19   masculine Human   &lt;chr [2]&gt;
##  2 C-3PO                 75 gold             112   masculine Droid   &lt;chr [0]&gt;
##  3 R2-D2                 32 white, blue       33   masculine Droid   &lt;chr [0]&gt;
##  4 Darth Vader          136 white             41.9 masculine Human   &lt;chr [0]&gt;
##  5 Leia Organa           49 light             19   feminine  Human   &lt;chr [1]&gt;
##  6 Owen Lars            120 light             52   masculine Human   &lt;chr [0]&gt;
##  7 Beru Whitesun lars    75 light             47   feminine  Human   &lt;chr [0]&gt;
##  8 R5-D4                 32 white, red        NA   masculine Droid   &lt;chr [0]&gt;
##  9 Biggs Darklighter     84 light             24   masculine Human   &lt;chr [0]&gt;
## 10 Obi-Wan Kenobi        77 fair              57   masculine Human   &lt;chr [1]&gt;
## # … with 77 more rows</code></pre>
<p><strong>Advanced:</strong> Using selection helpers (additional functions). More examples can be found <a href="https://dplyr.tidyverse.org/reference/select.html">here</a>.</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="ch-05.html#cb605-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span></code></pre></div>
<pre><code>## # A tibble: 87 x 3
##    height  mass birth_year
##     &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;
##  1    172    77       19  
##  2    167    75      112  
##  3     96    32       33  
##  4    202   136       41.9
##  5    150    49       19  
##  6    178   120       52  
##  7    165    75       47  
##  8     97    32       NA  
##  9    183    84       24  
## 10    182    77       57  
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="ch-05.html#cb607-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">last_col</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>))           <span class="co"># Last 3 columns</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 3
##    starships vehicles  films    
##    &lt;list&gt;    &lt;list&gt;    &lt;list&gt;   
##  1 &lt;chr [2]&gt; &lt;chr [2]&gt; &lt;chr [5]&gt;
##  2 &lt;chr [0]&gt; &lt;chr [0]&gt; &lt;chr [6]&gt;
##  3 &lt;chr [0]&gt; &lt;chr [0]&gt; &lt;chr [7]&gt;
##  4 &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [4]&gt;
##  5 &lt;chr [0]&gt; &lt;chr [1]&gt; &lt;chr [5]&gt;
##  6 &lt;chr [0]&gt; &lt;chr [0]&gt; &lt;chr [3]&gt;
##  7 &lt;chr [0]&gt; &lt;chr [0]&gt; &lt;chr [3]&gt;
##  8 &lt;chr [0]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
##  9 &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
## 10 &lt;chr [5]&gt; &lt;chr [1]&gt; &lt;chr [6]&gt;
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="ch-05.html#cb609-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">last_col</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">0</span>))           <span class="co"># Careful last_col() inedexes last column as 0</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 3
##    films     vehicles  starships
##    &lt;list&gt;    &lt;list&gt;    &lt;list&gt;   
##  1 &lt;chr [5]&gt; &lt;chr [2]&gt; &lt;chr [2]&gt;
##  2 &lt;chr [6]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
##  3 &lt;chr [7]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
##  4 &lt;chr [4]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
##  5 &lt;chr [5]&gt; &lt;chr [1]&gt; &lt;chr [0]&gt;
##  6 &lt;chr [3]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
##  7 &lt;chr [3]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
##  8 &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
##  9 &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
## 10 &lt;chr [6]&gt; &lt;chr [1]&gt; &lt;chr [5]&gt;
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="ch-05.html#cb611-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;h&quot;</span>))        <span class="co"># Selects all variables that start with an &quot;h&quot;</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 3
##    height hair_color    homeworld
##     &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;    
##  1    172 blond         Tatooine 
##  2    167 &lt;NA&gt;          Tatooine 
##  3     96 &lt;NA&gt;          Naboo    
##  4    202 none          Tatooine 
##  5    150 brown         Alderaan 
##  6    178 brown, grey   Tatooine 
##  7    165 brown         Tatooine 
##  8     97 &lt;NA&gt;          Tatooine 
##  9    183 black         Tatooine 
## 10    182 auburn, white Stewjon  
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="ch-05.html#cb613-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;color&quot;</span>))      <span class="co"># Selects all variables that end with &quot;color&quot;</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 3
##    hair_color    skin_color  eye_color
##    &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;    
##  1 blond         fair        blue     
##  2 &lt;NA&gt;          gold        yellow   
##  3 &lt;NA&gt;          white, blue red      
##  4 none          white       yellow   
##  5 brown         light       brown    
##  6 brown, grey   light       blue     
##  7 brown         light       blue     
##  8 &lt;NA&gt;          white, red  red      
##  9 black         light       brown    
## 10 auburn, white fair        blue-gray
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="ch-05.html#cb615-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;_&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 87 x 4
##    hair_color    skin_color  eye_color birth_year
##    &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;
##  1 blond         fair        blue            19  
##  2 &lt;NA&gt;          gold        yellow         112  
##  3 &lt;NA&gt;          white, blue red             33  
##  4 none          white       yellow          41.9
##  5 brown         light       brown           19  
##  6 brown, grey   light       blue            52  
##  7 brown         light       blue            47  
##  8 &lt;NA&gt;          white, red  red             NA  
##  9 black         light       brown           24  
## 10 auburn, white fair        blue-gray       57  
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="ch-05.html#cb617-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">matches</span>(<span class="st">&quot;height&quot;</span>))       <span class="co"># Same as select(height)</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 1
##    height
##     &lt;int&gt;
##  1    172
##  2    167
##  3     96
##  4    202
##  5    150
##  6    178
##  7    165
##  8     97
##  9    183
## 10    182
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="ch-05.html#cb619-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(<span class="fu">ends_with</span>(<span class="st">&quot;color&quot;</span>))) <span class="co"># Delete any variables that end with &quot;color&quot;. Note that any_of can only be used within select()!</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 11
##    name    height  mass birth_year sex   gender homeworld species films vehicles
##    &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;lis&gt; &lt;list&gt;  
##  1 Luke S…    172    77       19   male  mascu… Tatooine  Human   &lt;chr… &lt;chr [2…
##  2 C-3PO      167    75      112   none  mascu… Tatooine  Droid   &lt;chr… &lt;chr [0…
##  3 R2-D2       96    32       33   none  mascu… Naboo     Droid   &lt;chr… &lt;chr [0…
##  4 Darth …    202   136       41.9 male  mascu… Tatooine  Human   &lt;chr… &lt;chr [0…
##  5 Leia O…    150    49       19   fema… femin… Alderaan  Human   &lt;chr… &lt;chr [1…
##  6 Owen L…    178   120       52   male  mascu… Tatooine  Human   &lt;chr… &lt;chr [0…
##  7 Beru W…    165    75       47   fema… femin… Tatooine  Human   &lt;chr… &lt;chr [0…
##  8 R5-D4       97    32       NA   none  mascu… Tatooine  Droid   &lt;chr… &lt;chr [0…
##  9 Biggs …    183    84       24   male  mascu… Tatooine  Human   &lt;chr… &lt;chr [0…
## 10 Obi-Wa…    182    77       57   male  mascu… Stewjon   Human   &lt;chr… &lt;chr [1…
## # … with 77 more rows, and 1 more variable: starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="ch-05.html#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  (Using conditions is rarely meaningful...)</span></span>
<span id="cb621-2"><a href="ch-05.html#cb621-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">|</span> <span class="fu">length</span>(dat))           <span class="co"># Select columns one to for &quot;or&quot; the last one</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 5
##    name               height  mass hair_color    starships
##    &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;list&gt;   
##  1 Luke Skywalker        172    77 blond         &lt;chr [2]&gt;
##  2 C-3PO                 167    75 &lt;NA&gt;          &lt;chr [0]&gt;
##  3 R2-D2                  96    32 &lt;NA&gt;          &lt;chr [0]&gt;
##  4 Darth Vader           202   136 none          &lt;chr [1]&gt;
##  5 Leia Organa           150    49 brown         &lt;chr [0]&gt;
##  6 Owen Lars             178   120 brown, grey   &lt;chr [0]&gt;
##  7 Beru Whitesun lars    165    75 brown         &lt;chr [0]&gt;
##  8 R5-D4                  97    32 &lt;NA&gt;          &lt;chr [0]&gt;
##  9 Biggs Darklighter     183    84 black         &lt;chr [1]&gt;
## 10 Obi-Wan Kenobi        182    77 auburn, white &lt;chr [5]&gt;
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="ch-05.html#cb623-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">&amp;</span> (<span class="fu">starts_with</span>(<span class="st">&quot;h&quot;</span>)))    <span class="co"># Select cols 1:4 and all which start with &quot;h&quot;</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 2
##    height hair_color   
##     &lt;int&gt; &lt;chr&gt;        
##  1    172 blond        
##  2    167 &lt;NA&gt;         
##  3     96 &lt;NA&gt;         
##  4    202 none         
##  5    150 brown        
##  6    178 brown, grey  
##  7    165 brown        
##  8     97 &lt;NA&gt;         
##  9    183 black        
## 10    182 auburn, white
## # … with 77 more rows</code></pre>
<p><strong>Sidenote on using slice():</strong> slice() is similar to select() but less intuitive, thus better use filter()</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="ch-05.html#cb625-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>)                <span class="co"># Select first entry</span></span></code></pre></div>
<pre><code>## # A tibble: 1 x 14
##   name     height  mass hair_color skin_color eye_color birth_year sex   gender 
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
## 1 Luke Sk…    172    77 blond      fair       blue              19 male  mascul…
## # … with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="ch-05.html#cb627-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)             <span class="co"># Select top 10 entries</span></span></code></pre></div>
<pre><code>## # A tibble: 10 x 14
##    name    height  mass hair_color  skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Luke S…    172    77 blond       fair       blue            19   male  mascu…
##  2 C-3PO      167    75 &lt;NA&gt;        gold       yellow         112   none  mascu…
##  3 R2-D2       96    32 &lt;NA&gt;        white, bl… red             33   none  mascu…
##  4 Darth …    202   136 none        white      yellow          41.9 male  mascu…
##  5 Leia O…    150    49 brown       light      brown           19   fema… femin…
##  6 Owen L…    178   120 brown, grey light      blue            52   male  mascu…
##  7 Beru W…    165    75 brown       light      blue            47   fema… femin…
##  8 R5-D4       97    32 &lt;NA&gt;        white, red red             NA   none  mascu…
##  9 Biggs …    183    84 black       light      brown           24   male  mascu…
## 10 Obi-Wa…    182    77 auburn, wh… fair       blue-gray       57   male  mascu…
## # … with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="ch-05.html#cb629-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="fu">nrow</span>(dat))        <span class="co"># Select last entry</span></span></code></pre></div>
<pre><code>## # A tibble: 1 x 14
##   name     height  mass hair_color skin_color eye_color birth_year sex    gender
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; 
## 1 Padmé A…    165    45 brown      light      brown             46 female femin…
## # … with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="ch-05.html#cb631-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat)<span class="sc">-</span><span class="dv">1</span>)) <span class="co"># Delete everything from 1 to second last entry</span></span></code></pre></div>
<pre><code>## # A tibble: 1 x 14
##   name     height  mass hair_color skin_color eye_color birth_year sex    gender
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; 
## 1 Padmé A…    165    45 brown      light      brown             46 female femin…
## # … with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
<div id="filter" class="section level3" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Filter()</h3>
<p><code>filter()</code> provides a quick tool to pick certain entries using functions and conditions.
Here’s a quick overview on math and logic operators:</p>
<table>
<thead>
<tr class="header">
<th>Math Operators</th>
<th></th>
<th>Logic Operators</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Equal</td>
<td>==</td>
<td>a AND b</td>
<td>a, b <em>(or a &amp; b)</em></td>
</tr>
<tr class="even">
<td>Not Equal</td>
<td>!=</td>
<td>a OR b</td>
<td>a | b</td>
</tr>
<tr class="odd">
<td>Bigger</td>
<td>&gt;</td>
<td>EITHER a or b</td>
<td>xor(a, b)</td>
</tr>
<tr class="even">
<td>Equal or Smaller</td>
<td>&gt;=</td>
<td>NOT a</td>
<td>!a</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="ch-05.html#cb633-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reducing data for comprehensive output</span></span>
<span id="cb633-2"><a href="ch-05.html#cb633-2" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb633-3"><a href="ch-05.html#cb633-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-4"><a href="ch-05.html#cb633-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Numeric Criteria</span></span>
<span id="cb633-5"><a href="ch-05.html#cb633-5" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(height <span class="sc">&gt;</span> <span class="dv">100</span>)                <span class="co"># Entries with height above 100</span></span></code></pre></div>
<pre><code>## # A tibble: 74 x 8
##    name          height  mass hair_color   skin_color eye_color birth_year sex  
##    &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
##  1 Luke Skywalk…    172    77 blond        fair       blue            19   male 
##  2 C-3PO            167    75 &lt;NA&gt;         gold       yellow         112   none 
##  3 Darth Vader      202   136 none         white      yellow          41.9 male 
##  4 Leia Organa      150    49 brown        light      brown           19   fema…
##  5 Owen Lars        178   120 brown, grey  light      blue            52   male 
##  6 Beru Whitesu…    165    75 brown        light      blue            47   fema…
##  7 Biggs Darkli…    183    84 black        light      brown           24   male 
##  8 Obi-Wan Keno…    182    77 auburn, whi… fair       blue-gray       57   male 
##  9 Anakin Skywa…    188    84 blond        fair       blue            41.9 male 
## 10 Wilhuff Tark…    180    NA auburn, grey fair       blue            64   male 
## # … with 64 more rows</code></pre>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="ch-05.html#cb635-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(height <span class="sc">&gt;</span> <span class="dv">100</span> , mass <span class="sc">&gt;</span> <span class="dv">125</span>)   <span class="co"># Entries with height above 100 and mass above 125</span></span></code></pre></div>
<pre><code>## # A tibble: 5 x 8
##   name        height  mass hair_color skin_color   eye_color  birth_year sex    
##   &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;  
## 1 Darth Vader    202   136 none       white        yellow           41.9 male   
## 2 Jabba Desi…    175  1358 &lt;NA&gt;       green-tan, … orange          600   hermap…
## 3 IG-88          200   140 none       metal        red              15   none   
## 4 Grievous       216   159 none       brown, white green, ye…       NA   male   
## 5 Tarfful        234   136 brown      brown        blue             NA   male</code></pre>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="ch-05.html#cb637-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(height <span class="sc">&gt;</span> <span class="dv">100</span> <span class="sc">&amp;</span> mass <span class="sc">&gt;</span> <span class="dv">125</span>)   <span class="co"># &quot;</span></span></code></pre></div>
<pre><code>## # A tibble: 5 x 8
##   name        height  mass hair_color skin_color   eye_color  birth_year sex    
##   &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;  
## 1 Darth Vader    202   136 none       white        yellow           41.9 male   
## 2 Jabba Desi…    175  1358 &lt;NA&gt;       green-tan, … orange          600   hermap…
## 3 IG-88          200   140 none       metal        red              15   none   
## 4 Grievous       216   159 none       brown, white green, ye…       NA   male   
## 5 Tarfful        234   136 brown      brown        blue             NA   male</code></pre>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="ch-05.html#cb639-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mass <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;</span> mass <span class="sc">&lt;=</span> <span class="dv">55</span>)     <span class="co"># Entries with more than 50 and below 55 mass</span></span></code></pre></div>
<pre><code>## # A tibble: 4 x 8
##   name       height  mass hair_color skin_color       eye_color birth_year sex  
##   &lt;chr&gt;       &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
## 1 Ayla Secu…    178    55 none       blue             hazel             48 fema…
## 2 Adi Gallia    184    50 none       dark             blue              NA fema…
## 3 Barriss O…    166    50 black      yellow           blue              40 fema…
## 4 Zam Wesell    168    55 blonde     fair, green, ye… yellow            NA fema…</code></pre>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="ch-05.html#cb641-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">between</span>(mass, <span class="dv">50</span>, <span class="dv">55</span>))       <span class="co"># &quot;</span></span></code></pre></div>
<pre><code>## # A tibble: 4 x 8
##   name       height  mass hair_color skin_color       eye_color birth_year sex  
##   &lt;chr&gt;       &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
## 1 Ayla Secu…    178    55 none       blue             hazel             48 fema…
## 2 Adi Gallia    184    50 none       dark             blue              NA fema…
## 3 Barriss O…    166    50 black      yellow           blue              40 fema…
## 4 Zam Wesell    168    55 blonde     fair, green, ye… yellow            NA fema…</code></pre>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="ch-05.html#cb643-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">between</span>(height, <span class="dv">85</span>, <span class="dv">115</span>))    <span class="co"># Entries with height between 85 and 115</span></span></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   name             height  mass hair_color skin_color eye_color birth_year sex  
##   &lt;chr&gt;             &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
## 1 R2-D2                96    32 &lt;NA&gt;       white, bl… red               33 none 
## 2 R5-D4                97    32 &lt;NA&gt;       white, red red               NA none 
## 3 Wicket Systri W…     88    20 brown      brown      brown              8 male 
## 4 Sebulba             112    40 none       grey, red  orange            NA male 
## 5 Dud Bolt             94    45 none       blue, grey yellow            NA male 
## 6 R4-P17               96    NA none       silver, r… red, blue         NA none</code></pre>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="ch-05.html#cb645-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">near</span>(height, <span class="dv">100</span>, <span class="dv">15</span>))       <span class="co"># Entries with height 100 +/- 15 (same as line 106)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   name             height  mass hair_color skin_color eye_color birth_year sex  
##   &lt;chr&gt;             &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
## 1 R2-D2                96    32 &lt;NA&gt;       white, bl… red               33 none 
## 2 R5-D4                97    32 &lt;NA&gt;       white, red red               NA none 
## 3 Wicket Systri W…     88    20 brown      brown      brown              8 male 
## 4 Sebulba             112    40 none       grey, red  orange            NA male 
## 5 Dud Bolt             94    45 none       blue, grey yellow            NA male 
## 6 R4-P17               96    NA none       silver, r… red, blue         NA none</code></pre>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="ch-05.html#cb647-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Character Criteria</span></span>
<span id="cb647-2"><a href="ch-05.html#cb647-2" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">&quot;red&quot;</span>)          <span class="co"># Entries with red eyes</span></span></code></pre></div>
<pre><code>## # A tibble: 5 x 8
##   name        height  mass hair_color skin_color    eye_color birth_year sex  
##   &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;         &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
## 1 R2-D2           96    32 &lt;NA&gt;       white, blue   red               33 none 
## 2 R5-D4           97    32 &lt;NA&gt;       white, red    red               NA none 
## 3 IG-88          200   140 none       metal         red               15 none 
## 4 Bossk          190   113 none       green         red               53 male 
## 5 Nute Gunray    191    90 none       mottled green red               NA male</code></pre>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="ch-05.html#cb649-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(eye_color <span class="sc">!=</span> <span class="st">&quot;red&quot;</span>)          <span class="co"># Entries without red eyes</span></span></code></pre></div>
<pre><code>## # A tibble: 82 x 8
##    name          height  mass hair_color   skin_color eye_color birth_year sex  
##    &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
##  1 Luke Skywalk…    172    77 blond        fair       blue            19   male 
##  2 C-3PO            167    75 &lt;NA&gt;         gold       yellow         112   none 
##  3 Darth Vader      202   136 none         white      yellow          41.9 male 
##  4 Leia Organa      150    49 brown        light      brown           19   fema…
##  5 Owen Lars        178   120 brown, grey  light      blue            52   male 
##  6 Beru Whitesu…    165    75 brown        light      blue            47   fema…
##  7 Biggs Darkli…    183    84 black        light      brown           24   male 
##  8 Obi-Wan Keno…    182    77 auburn, whi… fair       blue-gray       57   male 
##  9 Anakin Skywa…    188    84 blond        fair       blue            41.9 male 
## 10 Wilhuff Tark…    180    NA auburn, grey fair       blue            64   male 
## # … with 72 more rows</code></pre>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="ch-05.html#cb651-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(eye_color <span class="sc">==</span> <span class="st">&quot;red&quot;</span>))       <span class="co"># Entries without red eyes</span></span></code></pre></div>
<pre><code>## # A tibble: 82 x 8
##    name          height  mass hair_color   skin_color eye_color birth_year sex  
##    &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
##  1 Luke Skywalk…    172    77 blond        fair       blue            19   male 
##  2 C-3PO            167    75 &lt;NA&gt;         gold       yellow         112   none 
##  3 Darth Vader      202   136 none         white      yellow          41.9 male 
##  4 Leia Organa      150    49 brown        light      brown           19   fema…
##  5 Owen Lars        178   120 brown, grey  light      blue            52   male 
##  6 Beru Whitesu…    165    75 brown        light      blue            47   fema…
##  7 Biggs Darkli…    183    84 black        light      brown           24   male 
##  8 Obi-Wan Keno…    182    77 auburn, whi… fair       blue-gray       57   male 
##  9 Anakin Skywa…    188    84 blond        fair       blue            41.9 male 
## 10 Wilhuff Tark…    180    NA auburn, grey fair       blue            64   male 
## # … with 72 more rows</code></pre>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="ch-05.html#cb653-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NA&#39;s</span></span>
<span id="cb653-2"><a href="ch-05.html#cb653-2" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> drop_na                             <span class="co"># Removes all entries with at least 1 NA</span></span></code></pre></div>
<pre><code>## # A tibble: 32 x 8
##    name          height  mass hair_color   skin_color eye_color birth_year sex  
##    &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
##  1 Luke Skywalk…    172    77 blond        fair       blue            19   male 
##  2 Darth Vader      202   136 none         white      yellow          41.9 male 
##  3 Leia Organa      150    49 brown        light      brown           19   fema…
##  4 Owen Lars        178   120 brown, grey  light      blue            52   male 
##  5 Beru Whitesu…    165    75 brown        light      blue            47   fema…
##  6 Biggs Darkli…    183    84 black        light      brown           24   male 
##  7 Obi-Wan Keno…    182    77 auburn, whi… fair       blue-gray       57   male 
##  8 Anakin Skywa…    188    84 blond        fair       blue            41.9 male 
##  9 Chewbacca        228   112 brown        unknown    blue           200   male 
## 10 Han Solo         180    80 brown        fair       brown           29   male 
## # … with 22 more rows</code></pre>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="ch-05.html#cb655-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pick values from a vector using %in%</span></span>
<span id="cb655-2"><a href="ch-05.html#cb655-2" aria-hidden="true" tabindex="-1"></a>eyes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;none&quot;</span>)                          <span class="co"># Defining vector with wanted eye colors</span></span>
<span id="cb655-3"><a href="ch-05.html#cb655-3" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(eye_color <span class="sc">%in%</span> eyes)                       <span class="co"># Entries with wanted eye colors</span></span></code></pre></div>
<pre><code>## # A tibble: 15 x 8
##    name       height  mass hair_color skin_color      eye_color birth_year sex  
##    &lt;chr&gt;       &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;           &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
##  1 R2-D2          96    32 &lt;NA&gt;       white, blue     red               33 none 
##  2 R5-D4          97    32 &lt;NA&gt;       white, red      red               NA none 
##  3 Greedo        173    74 &lt;NA&gt;       green           black             44 male 
##  4 IG-88         200   140 none       metal           red               15 none 
##  5 Bossk         190   113 none       green           red               53 male 
##  6 Nien Nunb     160    68 none       grey            black             NA male 
##  7 Nute Gunr…    191    90 none       mottled green   red               NA male 
##  8 Gasgano       122    NA none       white, blue     black             NA male 
##  9 Kit Fisto     196    87 none       green           black             NA male 
## 10 Plo Koon      188    80 none       orange          black             22 male 
## 11 Lama Su       229    88 none       grey            black             NA male 
## 12 Taun We       213    NA none       grey            black             NA fema…
## 13 Shaak Ti      178    57 none       red, blue, whi… black             NA fema…
## 14 Tion Medon    206    80 none       grey            black             NA male 
## 15 BB8            NA    NA none       none            black             NA none</code></pre>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="ch-05.html#cb657-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(eye_color <span class="sc">%in%</span> eyes <span class="sc">&amp;</span>  <span class="fu">is.na</span>(birth_year))  <span class="co"># Entries with wanted eye colors and missing birthdate</span></span></code></pre></div>
<pre><code>## # A tibble: 10 x 8
##    name       height  mass hair_color skin_color      eye_color birth_year sex  
##    &lt;chr&gt;       &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;           &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
##  1 R5-D4          97    32 &lt;NA&gt;       white, red      red               NA none 
##  2 Nien Nunb     160    68 none       grey            black             NA male 
##  3 Nute Gunr…    191    90 none       mottled green   red               NA male 
##  4 Gasgano       122    NA none       white, blue     black             NA male 
##  5 Kit Fisto     196    87 none       green           black             NA male 
##  6 Lama Su       229    88 none       grey            black             NA male 
##  7 Taun We       213    NA none       grey            black             NA fema…
##  8 Shaak Ti      178    57 none       red, blue, whi… black             NA fema…
##  9 Tion Medon    206    80 none       grey            black             NA male 
## 10 BB8            NA    NA none       none            black             NA none</code></pre>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="ch-05.html#cb659-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Negations</span></span>
<span id="cb659-2"><a href="ch-05.html#cb659-2" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(eye_color <span class="sc">%in%</span> eyes))                    <span class="co"># No (!) entries with wanted eye colors</span></span></code></pre></div>
<pre><code>## # A tibble: 72 x 8
##    name          height  mass hair_color   skin_color eye_color birth_year sex  
##    &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
##  1 Luke Skywalk…    172    77 blond        fair       blue            19   male 
##  2 C-3PO            167    75 &lt;NA&gt;         gold       yellow         112   none 
##  3 Darth Vader      202   136 none         white      yellow          41.9 male 
##  4 Leia Organa      150    49 brown        light      brown           19   fema…
##  5 Owen Lars        178   120 brown, grey  light      blue            52   male 
##  6 Beru Whitesu…    165    75 brown        light      blue            47   fema…
##  7 Biggs Darkli…    183    84 black        light      brown           24   male 
##  8 Obi-Wan Keno…    182    77 auburn, whi… fair       blue-gray       57   male 
##  9 Anakin Skywa…    188    84 blond        fair       blue            41.9 male 
## 10 Wilhuff Tark…    180    NA auburn, grey fair       blue            64   male 
## # … with 62 more rows</code></pre>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="ch-05.html#cb661-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(eye_color <span class="sc">%in%</span> eyes <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(birth_year))  <span class="co"># Entries with wanted eye colors but no missing birthdate</span></span></code></pre></div>
<pre><code>## # A tibble: 5 x 8
##   name     height  mass hair_color skin_color  eye_color birth_year sex  
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
## 1 R2-D2        96    32 &lt;NA&gt;       white, blue red               33 none 
## 2 Greedo      173    74 &lt;NA&gt;       green       black             44 male 
## 3 IG-88       200   140 none       metal       red               15 none 
## 4 Bossk       190   113 none       green       red               53 male 
## 5 Plo Koon    188    80 none       orange      black             22 male</code></pre>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="ch-05.html#cb663-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(sex))                             <span class="co"># Entries where sex is NA</span></span></code></pre></div>
<pre><code>## # A tibble: 4 x 8
##   name           height  mass hair_color skin_color eye_color birth_year sex  
##   &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
## 1 Ric Olié          183    NA brown      fair       blue              NA &lt;NA&gt; 
## 2 Quarsh Panaka     183    NA black      dark       brown             62 &lt;NA&gt; 
## 3 Sly Moore         178    48 none       pale       white             NA &lt;NA&gt; 
## 4 Captain Phasma     NA    NA unknown    unknown    unknown           NA &lt;NA&gt;</code></pre>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="ch-05.html#cb665-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span> nrow                    <span class="co"># Number of entries where sex is NA</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="ch-05.html#cb667-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.na</span>(hair_color))       <span class="co"># Remove entries where sex or hair color is missing</span></span></code></pre></div>
<pre><code>## # A tibble: 87 x 8
##    name          height  mass hair_color   skin_color eye_color birth_year sex  
##    &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
##  1 Luke Skywalk…    172    77 blond        fair       blue            19   male 
##  2 C-3PO            167    75 &lt;NA&gt;         gold       yellow         112   none 
##  3 R2-D2             96    32 &lt;NA&gt;         white, bl… red             33   none 
##  4 Darth Vader      202   136 none         white      yellow          41.9 male 
##  5 Leia Organa      150    49 brown        light      brown           19   fema…
##  6 Owen Lars        178   120 brown, grey  light      blue            52   male 
##  7 Beru Whitesu…    165    75 brown        light      blue            47   fema…
##  8 R5-D4             97    32 &lt;NA&gt;         white, red red             NA   none 
##  9 Biggs Darkli…    183    84 black        light      brown           24   male 
## 10 Obi-Wan Keno…    182    77 auburn, whi… fair       blue-gray       57   male 
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="ch-05.html#cb669-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter functions</span></span>
<span id="cb669-2"><a href="ch-05.html#cb669-2" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">top_n</span>(<span class="dv">3</span>)  <span class="co"># Selects highest values of given number of numeric columns</span></span></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   name   height  mass hair_color skin_color  eye_color birth_year sex  
##   &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
## 1 C-3PO     167    75 &lt;NA&gt;       gold        yellow           112 none 
## 2 R2-D2      96    32 &lt;NA&gt;       white, blue red               33 none 
## 3 R5-D4      97    32 &lt;NA&gt;       white, red  red               NA none 
## 4 IG-88     200   140 none       metal       red               15 none 
## 5 R4-P17     96    NA none       silver, red red, blue         NA none 
## 6 BB8        NA    NA none       none        black             NA none</code></pre>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="ch-05.html#cb671-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">top_n</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="co"># Selects lowest values of given number of numeric columns</span></span></code></pre></div>
<pre><code>## # A tibble: 16 x 8
##    name        height  mass hair_color skin_color     eye_color birth_year sex  
##    &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
##  1 Leia Organa    150  49   brown      light          brown             19 fema…
##  2 Beru White…    165  75   brown      light          blue              47 fema…
##  3 Mon Mothma     150  NA   auburn     fair           blue              48 fema…
##  4 Shmi Skywa…    163  NA   black      fair           brown             72 fema…
##  5 Ayla Secura    178  55   none       blue           hazel             48 fema…
##  6 Adi Gallia     184  50   none       dark           blue              NA fema…
##  7 Cordé          157  NA   brown      light          brown             NA fema…
##  8 Luminara U…    170  56.2 black      yellow         blue              58 fema…
##  9 Barriss Of…    166  50   black      yellow         blue              40 fema…
## 10 Dormé          165  NA   brown      light          brown             NA fema…
## 11 Zam Wesell     168  55   blonde     fair, green, … yellow            NA fema…
## 12 Taun We        213  NA   none       grey           black             NA fema…
## 13 Jocasta Nu     167  NA   white      fair           blue              NA fema…
## 14 Shaak Ti       178  57   none       red, blue, wh… black             NA fema…
## 15 Rey             NA  NA   brown      light          hazel             NA fema…
## 16 Padmé Amid…    165  45   brown      light          brown             46 fema…</code></pre>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="ch-05.html#cb673-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span> <span class="fu">top_n</span>(<span class="sc">-</span><span class="dv">1</span>, birth_year)        <span class="co"># Give the youngest of each sex</span></span></code></pre></div>
<pre><code>## # A tibble: 5 x 8
## # Groups:   sex [5]
##   name        height  mass hair_color skin_color   eye_color birth_year sex     
##   &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;   
## 1 Leia Organa    150    49 brown      light        brown             19 female  
## 2 Jabba Desi…    175  1358 &lt;NA&gt;       green-tan, … orange           600 hermaph…
## 3 IG-88          200   140 none       metal        red               15 none    
## 4 Wicket Sys…     88    20 brown      brown        brown              8 male    
## 5 Quarsh Pan…    183    NA black      dark         brown             62 &lt;NA&gt;</code></pre>
<p>Other useful filter functions: filter_if(), filter_at(). Examples can be found <a href="https://suzan.rbind.io/2018/02/dplyr-tutorial-3/">here</a>.</p>
</div>
<div id="exercises" class="section level3" number="5.5.4">
<h3><span class="header-section-number">5.5.4</span> Exercises</h3>
<ol style="list-style-type: lower-alpha">
<li><p>How many pale characters are there from planet Ryloth or Naboo?</p></li>
<li><p>Who is the oldest of the tallest 5 characters?</p></li>
<li><p>Who has the most starships?</p>
<p>Hints: Try to Google: Unlist into new columns or check this stackoverflow <a href="https://stackoverflow.com/questions/26194298/unlist-data-frame-column-preserving-information-from-other-column">post</a></p></li>
<li><p>Find name and starship of the smallest character in “Return of the Jedi”</p>
<p>Hints: filter_at or this stackoverflow <a href="https://stackoverflow.com/questions/26194298/unlist-data-frame-column-preserving-information-from-other-column">post</a></p></li>
</ol>
</div>
<div id="solutions" class="section level3" number="5.5.5">
<h3><span class="header-section-number">5.5.5</span> Solutions</h3>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="ch-05.html#cb675-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb675-2"><a href="ch-05.html#cb675-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(skin_color <span class="sc">==</span> <span class="st">&quot;pale&quot;</span>, homeworld <span class="sc">==</span> <span class="st">&quot;Naboo&quot;</span> <span class="sc">|</span> homeworld <span class="sc">==</span> <span class="st">&quot;Ryloth&quot;</span>) <span class="sc">%&gt;%</span> nrow      </span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="ch-05.html#cb677-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb677-2"><a href="ch-05.html#cb677-2" aria-hidden="true" tabindex="-1"></a>dat1 <span class="sc">%&gt;%</span> <span class="fu">top_n</span>(<span class="dv">5</span>, height) <span class="sc">%&gt;%</span> <span class="fu">top_n</span>(<span class="dv">1</span>, birth_year)    </span></code></pre></div>
<pre><code>## # A tibble: 1 x 8
##   name      height  mass hair_color skin_color eye_color birth_year sex  
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
## 1 Chewbacca    228   112 brown      unknown    blue             200 male</code></pre>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="ch-05.html#cb679-1" aria-hidden="true" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb679-2"><a href="ch-05.html#cb679-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">unnest_wider</span>(starships) <span class="sc">%&gt;%</span> <span class="fu">filter_at</span>(<span class="fu">vars</span>(<span class="fu">contains</span>(<span class="st">&quot;...&quot;</span>)), <span class="fu">all_vars</span>(<span class="sc">!</span><span class="fu">is.na</span>(.)))  </span></code></pre></div>
<pre><code>## # A tibble: 1 x 18
##   name     height  mass hair_color  skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Obi-Wan…    182    77 auburn, wh… fair       blue-gray         57 male  mascu…
## # … with 9 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, ...1 &lt;chr&gt;, ...2 &lt;chr&gt;, ...3 &lt;chr&gt;, ...4 &lt;chr&gt;, ...5 &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="ch-05.html#cb681-1" aria-hidden="true" tabindex="-1"></a><span class="co"># d.</span></span>
<span id="cb681-2"><a href="ch-05.html#cb681-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(starships) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(films <span class="sc">==</span> <span class="st">&quot;Return of the Jedi&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">top_n</span>(<span class="sc">-</span><span class="dv">1</span>, height) <span class="sc">%&gt;%</span> <span class="fu">select</span>(name, starships) </span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   name      starships        
##   &lt;chr&gt;     &lt;chr&gt;            
## 1 Nien Nunb Millennium Falcon</code></pre>
</div>
</div>
<div id="preparing-data-for-ggplot" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Preparing data for ggplot()</h2>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="ch-05.html#cb683-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb683-2"><a href="ch-05.html#cb683-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb683-3"><a href="ch-05.html#cb683-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb683-4"><a href="ch-05.html#cb683-4" aria-hidden="true" tabindex="-1"></a>?pivot_longer</span></code></pre></div>
<p><strong>Example 1:</strong></p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="ch-05.html#cb684-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="ch-05.html#cb686-1" aria-hidden="true" tabindex="-1"></a>iris.long <span class="ot">&lt;-</span> iris[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb686-2"><a href="ch-05.html#cb686-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, </span>
<span id="cb686-3"><a href="ch-05.html#cb686-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, </span>
<span id="cb686-4"><a href="ch-05.html#cb686-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb686-5"><a href="ch-05.html#cb686-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris.long)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   variable     value
##   &lt;chr&gt;        &lt;dbl&gt;
## 1 Sepal.Length   5.1
## 2 Sepal.Width    3.5
## 3 Petal.Length   1.4
## 4 Petal.Width    0.2
## 5 Sepal.Length   4.9
## 6 Sepal.Width    3</code></pre>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="ch-05.html#cb688-1" aria-hidden="true" tabindex="-1"></a>iris.long <span class="sc">%&gt;%</span> </span>
<span id="cb688-2"><a href="ch-05.html#cb688-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> variable)) <span class="sc">+</span></span>
<span id="cb688-3"><a href="ch-05.html#cb688-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>()</span></code></pre></div>
<p><img src="esds_book_files/figure-html/unnamed-chunk-308-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p><strong>Example 2:</strong></p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="ch-05.html#cb689-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_income)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 11
##   religion  `&lt;$10k` `$10-20k` `$20-30k` `$30-40k` `$40-50k` `$50-75k` `$75-100k`
##   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1 Agnostic       27        34        60        81        76       137        122
## 2 Atheist        12        27        37        52        35        70         73
## 3 Buddhist       27        21        30        34        33        58         62
## 4 Catholic      418       617       732       670       638      1116        949
## 5 Don’t kn…      15        14        15        11        10        35         21
## 6 Evangeli…     575       869      1064       982       881      1486        949
## # … with 3 more variables: $100-150k &lt;dbl&gt;, &gt;150k &lt;dbl&gt;,
## #   Don&#39;t know/refused &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="ch-05.html#cb691-1" aria-hidden="true" tabindex="-1"></a>relig_income</span></code></pre></div>
<pre><code>## # A tibble: 18 x 11
##    religion `&lt;$10k` `$10-20k` `$20-30k` `$30-40k` `$40-50k` `$50-75k` `$75-100k`
##    &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
##  1 Agnostic      27        34        60        81        76       137        122
##  2 Atheist       12        27        37        52        35        70         73
##  3 Buddhist      27        21        30        34        33        58         62
##  4 Catholic     418       617       732       670       638      1116        949
##  5 Don’t k…      15        14        15        11        10        35         21
##  6 Evangel…     575       869      1064       982       881      1486        949
##  7 Hindu          1         9         7         9        11        34         47
##  8 Histori…     228       244       236       238       197       223        131
##  9 Jehovah…      20        27        24        24        21        30         15
## 10 Jewish        19        19        25        25        30        95         69
## 11 Mainlin…     289       495       619       655       651      1107        939
## 12 Mormon        29        40        48        51        56       112         85
## 13 Muslim         6         7         9        10         9        23         16
## 14 Orthodox      13        17        23        32        32        47         38
## 15 Other C…       9         7        11        13        13        14         18
## 16 Other F…      20        33        40        46        49        63         46
## 17 Other W…       5         2         3         4         2         7          3
## 18 Unaffil…     217       299       374       365       341       528        407
## # … with 3 more variables: $100-150k &lt;dbl&gt;, &gt;150k &lt;dbl&gt;,
## #   Don&#39;t know/refused &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="ch-05.html#cb693-1" aria-hidden="true" tabindex="-1"></a>relig_income_long <span class="ot">&lt;-</span> relig_income <span class="sc">%&gt;%</span></span>
<span id="cb693-2"><a href="ch-05.html#cb693-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>religion, <span class="at">names_to =</span> <span class="st">&quot;income&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>)</span>
<span id="cb693-3"><a href="ch-05.html#cb693-3" aria-hidden="true" tabindex="-1"></a>relig_income_long <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb693-4"><a href="ch-05.html#cb693-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span> </span>
<span id="cb693-5"><a href="ch-05.html#cb693-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="esds_book_files/figure-html/unnamed-chunk-309-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p><strong>Example 3:</strong></p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="ch-05.html#cb694-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">country=</span><span class="fu">c</span>(<span class="st">&#39;Afghanistan&#39;</span>,</span>
<span id="cb694-2"><a href="ch-05.html#cb694-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;Brazil&#39;</span>,<span class="st">&#39;China&#39;</span>),</span>
<span id="cb694-3"><a href="ch-05.html#cb694-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">&#39;1999&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">745</span>,<span class="dv">37737</span>,<span class="dv">212258</span>),</span>
<span id="cb694-4"><a href="ch-05.html#cb694-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&#39;2000&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">2666</span>,<span class="dv">80488</span>,<span class="dv">213768</span>))</span>
<span id="cb694-5"><a href="ch-05.html#cb694-5" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   country     `1999` `2000`
##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
## 1 Afghanistan    745   2666
## 2 Brazil       37737  80488
## 3 China       212258 213768</code></pre>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="ch-05.html#cb696-1" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb696-2"><a href="ch-05.html#cb696-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>country, <span class="at">names_to=</span><span class="st">&quot;year&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;cases&quot;</span>)</span>
<span id="cb696-3"><a href="ch-05.html#cb696-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb696-4"><a href="ch-05.html#cb696-4" aria-hidden="true" tabindex="-1"></a><span class="co"># equivalently:</span></span>
<span id="cb696-5"><a href="ch-05.html#cb696-5" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb696-6"><a href="ch-05.html#cb696-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">&#39;1999&#39;</span>,<span class="st">&#39;2000&#39;</span>), <span class="at">names_to=</span><span class="st">&quot;year&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;cases&quot;</span>)</span>
<span id="cb696-7"><a href="ch-05.html#cb696-7" aria-hidden="true" tabindex="-1"></a>df_long</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country     year   cases
##   &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
## 1 Afghanistan 1999     745
## 2 Afghanistan 2000    2666
## 3 Brazil      1999   37737
## 4 Brazil      2000   80488
## 5 China       1999  212258
## 6 China       2000  213768</code></pre>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="ch-05.html#cb698-1" aria-hidden="true" tabindex="-1"></a>df_long <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> cases, <span class="at">shape=</span> country, <span class="at">color=</span>country)) <span class="sc">+</span></span>
<span id="cb698-2"><a href="ch-05.html#cb698-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="esds_book_files/figure-html/unnamed-chunk-310-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="base-r-functions" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Base R functions</h2>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="ch-05.html#cb699-1" aria-hidden="true" tabindex="-1"></a><span class="do">## lapply </span></span>
<span id="cb699-2"><a href="ch-05.html#cb699-2" aria-hidden="true" tabindex="-1"></a><span class="co"># returns a list of the same length as X, </span></span>
<span id="cb699-3"><a href="ch-05.html#cb699-3" aria-hidden="true" tabindex="-1"></a>?lapply</span>
<span id="cb699-4"><a href="ch-05.html#cb699-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="ch-05.html#cb701-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(iris[,<span class="sc">-</span><span class="dv">5</span>],mean) <span class="co"># exclude the Species column</span></span></code></pre></div>
<pre><code>## $Sepal.Length
## [1] 5.843333
## 
## $Sepal.Width
## [1] 3.057333
## 
## $Petal.Length
## [1] 3.758
## 
## $Petal.Width
## [1] 1.199333</code></pre>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="ch-05.html#cb703-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sapply </span></span>
<span id="cb703-2"><a href="ch-05.html#cb703-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a user-friendly version and wrapper of lapply </span></span>
<span id="cb703-3"><a href="ch-05.html#cb703-3" aria-hidden="true" tabindex="-1"></a><span class="co"># by default returning a vector, matrix </span></span>
<span id="cb703-4"><a href="ch-05.html#cb703-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(iris[,<span class="sc">-</span><span class="dv">5</span>],mean)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##     5.843333     3.057333     3.758000     1.199333</code></pre>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="ch-05.html#cb705-1" aria-hidden="true" tabindex="-1"></a><span class="do">## substr()</span></span>
<span id="cb705-2"><a href="ch-05.html#cb705-2" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="st">&#39;APPLE&#39;</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] &quot;PPL&quot;</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="ch-05.html#cb707-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="st">&#39;AP PLE&#39;</span>,<span class="dv">2</span>,<span class="dv">4</span>) <span class="co"># spacing counts</span></span></code></pre></div>
<pre><code>## [1] &quot;P P&quot;</code></pre>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="ch-05.html#cb709-1" aria-hidden="true" tabindex="-1"></a><span class="do">## gregexpr()</span></span>
<span id="cb709-2"><a href="ch-05.html#cb709-2" aria-hidden="true" tabindex="-1"></a>?gregexpr</span>
<span id="cb709-3"><a href="ch-05.html#cb709-3" aria-hidden="true" tabindex="-1"></a>sequences<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;ACATGTCATGTCC&quot;</span>,<span class="st">&quot;CTTGTATGCTG&quot;</span>)</span>
<span id="cb709-4"><a href="ch-05.html#cb709-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gregexpr</span>(<span class="st">&quot;ATG&quot;</span>,sequences)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 3 8
## attr(,&quot;match.length&quot;)
## [1] 3 3
## attr(,&quot;index.type&quot;)
## [1] &quot;chars&quot;
## attr(,&quot;useBytes&quot;)
## [1] TRUE
## 
## [[2]]
## [1] 6
## attr(,&quot;match.length&quot;)
## [1] 3
## attr(,&quot;index.type&quot;)
## [1] &quot;chars&quot;
## attr(,&quot;useBytes&quot;)
## [1] TRUE</code></pre>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="ch-05.html#cb711-1" aria-hidden="true" tabindex="-1"></a><span class="do">## regexec() and gregexpr()</span></span>
<span id="cb711-2"><a href="ch-05.html#cb711-2" aria-hidden="true" tabindex="-1"></a>?<span class="fu">regexec</span>()</span>
<span id="cb711-3"><a href="ch-05.html#cb711-3" aria-hidden="true" tabindex="-1"></a>pattern <span class="ot">&lt;-</span> <span class="st">&quot;([[:alpha:]]+)([[:digit:]]+)&quot;</span> </span>
<span id="cb711-4"><a href="ch-05.html#cb711-4" aria-hidden="true" tabindex="-1"></a><span class="co"># alphabetic characters + digits</span></span>
<span id="cb711-5"><a href="ch-05.html#cb711-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-6"><a href="ch-05.html#cb711-6" aria-hidden="true" tabindex="-1"></a><span class="do">######123456789</span></span>
<span id="cb711-7"><a href="ch-05.html#cb711-7" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="st">&quot;Test: A1 BC23 DEF456&quot;</span></span>
<span id="cb711-8"><a href="ch-05.html#cb711-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-9"><a href="ch-05.html#cb711-9" aria-hidden="true" tabindex="-1"></a><span class="fu">regexec</span>(pattern,s)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 7 7 8
## attr(,&quot;match.length&quot;)
## [1] 2 1 1
## attr(,&quot;index.type&quot;)
## [1] &quot;chars&quot;
## attr(,&quot;useBytes&quot;)
## [1] TRUE</code></pre>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="ch-05.html#cb713-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only record the location of first match</span></span>
<span id="cb713-2"><a href="ch-05.html#cb713-2" aria-hidden="true" tabindex="-1"></a><span class="fu">regmatches</span>(s, <span class="fu">regexec</span>(pattern,s)) </span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;A1&quot; &quot;A&quot;  &quot;1&quot;</code></pre>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="ch-05.html#cb715-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns only the first match</span></span>
<span id="cb715-2"><a href="ch-05.html#cb715-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb715-3"><a href="ch-05.html#cb715-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb715-4"><a href="ch-05.html#cb715-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gregexpr</span>(pattern, s) </span></code></pre></div>
<pre><code>## [[1]]
## [1]  7 10 15
## attr(,&quot;match.length&quot;)
## [1] 2 4 6
## attr(,&quot;index.type&quot;)
## [1] &quot;chars&quot;
## attr(,&quot;useBytes&quot;)
## [1] TRUE</code></pre>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="ch-05.html#cb717-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the location of all matched substrings</span></span>
<span id="cb717-2"><a href="ch-05.html#cb717-2" aria-hidden="true" tabindex="-1"></a><span class="fu">regmatches</span>(s, <span class="fu">gregexpr</span>(pattern, s)) </span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;A1&quot;     &quot;BC23&quot;   &quot;DEF456&quot;</code></pre>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="ch-05.html#cb719-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract all matched substrings</span></span>
<span id="cb719-2"><a href="ch-05.html#cb719-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb719-3"><a href="ch-05.html#cb719-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(</span>
<span id="cb719-4"><a href="ch-05.html#cb719-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">regmatches</span>(s, <span class="fu">gregexpr</span>(pattern, s)), <span class="co"># all matched strings</span></span>
<span id="cb719-5"><a href="ch-05.html#cb719-5" aria-hidden="true" tabindex="-1"></a>       <span class="co"># get the matching substings and elements</span></span>
<span id="cb719-6"><a href="ch-05.html#cb719-6" aria-hidden="true" tabindex="-1"></a>       <span class="cf">function</span>(e) <span class="fu">regmatches</span>(e, <span class="fu">regexec</span>(pattern, e))) </span></code></pre></div>
<pre><code>## [[1]]
## [[1]][[1]]
## [1] &quot;A1&quot; &quot;A&quot;  &quot;1&quot; 
## 
## [[1]][[2]]
## [1] &quot;BC23&quot; &quot;BC&quot;   &quot;23&quot;  
## 
## [[1]][[3]]
## [1] &quot;DEF456&quot; &quot;DEF&quot;    &quot;456&quot;</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-04.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-06.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
